var zt=Object.create;var Me=Object.defineProperty;var Jt=Object.getOwnPropertyDescriptor;var jt=Object.getOwnPropertyNames;var Zt=Object.getPrototypeOf,Xt=Object.prototype.hasOwnProperty;var qt=(e,t)=>{for(var n in t)Me(e,n,{get:t[n],enumerable:!0})},rt=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of jt(t))!Xt.call(e,a)&&a!==n&&Me(e,a,{get:()=>t[a],enumerable:!(r=Jt(t,a))||r.enumerable});return e};var De=(e,t,n)=>(n=e!=null?zt(Zt(e)):{},rt(t||!e||!e.__esModule?Me(n,"default",{value:e,enumerable:!0}):n,e)),en=e=>rt(Me({},"__esModule",{value:!0}),e);var Pn={};qt(Pn,{ZeroPermit:()=>se,addresses:()=>d,checkSdkVersionSupport:()=>Ne,createApproveInstruction:()=>Ye,createAssociatedTokenAccountInstruction:()=>$,createCloseAccountInstruction:()=>Tt,createMctpFromSolanaInstructions:()=>et,createSplTransferInstruction:()=>me,createSwapFromSolanaInstructions:()=>Dt,createSyncNativeInstruction:()=>de,decentralizeClientSwapInstructions:()=>Se,decideRelayer:()=>Je,deserializeInstructionInfo:()=>Ae,estimateQuoteRequiredGas:()=>wn,estimateQuoteRequiredGasAprox:()=>An,fetchAllTokenList:()=>an,fetchQuote:()=>on,fetchTokenList:()=>sn,generateFetchQuoteUrl:()=>ot,getAddressLookupTableAccounts:()=>he,getAmountOfFractionalAmount:()=>w,getAnchorInstructionData:()=>ze,getAssociatedTokenAddress:()=>_,getCurrentChainTime:()=>pn,getDisplayAmount:()=>nn,getEvmChainIdByName:()=>Be,getGasDecimal:()=>N,getGasDecimalsInSolana:()=>Ke,getJitoTipTransfer:()=>je,getMctpFromEvmTxPayload:()=>$e,getQuoteSuitableReferrerAddress:()=>ce,getSafeU64Blob:()=>O,getSdkVersion:()=>We,getSuggestedRelayer:()=>Ue,getSwapFromEvmTxPayload:()=>Oe,getSwapSolana:()=>Te,getWormholeChainIdById:()=>Z,getWormholeChainIdByName:()=>R,hexToUint8Array:()=>v,isValidAptosType:()=>it,nativeAddressToHexString:()=>A,sendJitoBundle:()=>Ze,solMint:()=>q,submitSwiftEvmSwap:()=>Qe,submitSwiftSolanaSwap:()=>He,submitTransactionWithRetry:()=>Ie,swapFromEvm:()=>Tn,swapFromSolana:()=>Cn,unwrapSol:()=>mn,wait:()=>Le,wrapSol:()=>dn});module.exports=en(Pn);var X=De(require("cross-fetch"));var d={MAYAN_FORWARDER_CONTRACT:"0x0654874eb7F59C6f5b39931FC45dC45337c967c3",MAYAN_PROGRAM_ID:"FC4eXxkyrMPTjiYUpp4EAnkmwMbQyZ6NDCh1kfLn6vsf",AUCTION_PROGRAM_ID:"8QJmxZcEzwuYmCPy6XqgN2sHcYCcFq6AEfBMJZZuLo5a",MCTP_PROGRAM_ID:"Awm2zSgzMGTRraAVjRvshqLehy7mJ2Qr3maURDsoDmwi",SWIFT_PROGRAM_ID:"BLZRi6frs4X4DNLw56V4EXai1b6QVESN1BhHBTYM9VcY",FEE_MANAGER_PROGRAM_ID:"5VtQHnhs2pfVEr68qQsbTRwKh4JV5GTu9mBHgHFxpHeQ",WORMHOLE_PROGRAM_ID:"worm2ZoG2kUd4vFXhvjh93UUH596ayRfgQ2MgjNMTth",CCTP_CORE_PROGRAM_ID:"CCTPmbSD7gX1bxKPAmg77w8oFzNFpaQiQUWD43TKaecd",CCTP_TOKEN_PROGRAM_ID:"CCTPiPYPc6AsJuwueEnWgSgucamXDZwBd53dQ11YiKX3",TOKEN_PROGRAM_ID:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",ASSOCIATED_TOKEN_PROGRAM_ID:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",LOOKUP_TABLE:"75X8YgJPcadksw6Ag3qsYUfi1bsFwDoCKYtqPPqdydAG",EXPLORER_URL:"https://explorer-api.mayan.finance/v3",PRICE_URL:"https://price-api.mayan.finance/v3",RELAYER_URL:"https://relayer-api.mayan.finance/v3"};var ie=require("ethers"),j=require("@solana/web3.js"),xe=require("buffer");var at=De(require("js-sha3")),tn=at.sha3_256,it=e=>/^(0x)?[0-9a-fA-F]+::\w+::\w+$/.test(e);function A(e,t){if(t===1)return(0,ie.zeroPadValue)(new j.PublicKey(e).toBytes(),32);if(t===2||t===4||t===5||t===6||t===23||t===24||t===30)return(0,ie.zeroPadValue)(e,32);if(t===22&&it(e))return`0x${tn(e)}`;throw console.log(`Unsupported chain id: ${t}`,e),new Error("Unsupported token chain")}function v(e){return new Uint8Array(xe.Buffer.from(e.startsWith("0x")?e.substring(2):e,"hex"))}function _(e,t,n=!1,r=new j.PublicKey(d.TOKEN_PROGRAM_ID),a=new j.PublicKey(d.ASSOCIATED_TOKEN_PROGRAM_ID)){if(!n&&!j.PublicKey.isOnCurve(t.toBuffer()))throw new Error("TokenOwnerOffCurveError");let[o]=j.PublicKey.findProgramAddressSync([t.toBuffer(),r.toBuffer(),e.toBuffer()],a);return o}function w(e,t){if(e==null)throw new Error("getAmountOfFractionalAmount: Amount is null or undefined");if(typeof e!="string"&&typeof e!="number")throw new Error("getAmountOfFractionalAmount: Amount is not a string or number");if(typeof e=="string"&&e.length===0)throw new Error("getAmountOfFractionalAmount: Amount is empty");if(!Number.isFinite(Number(e)))throw new Error("getAmountOfFractionalAmount: Amount is not a number");let n=Math.min(8,Number(t)),r=Number(e).toFixed(n+1),a=new RegExp(`^-?\\d+(?:\\.\\d{0,${n}})?`),o=r.match(a);if(!o)throw new Error("getAmountOfFractionalAmount: fixedAmount is null");let i=o[0];return(0,ie.parseUnits)(i,Number(t))}function nn(e,t){return Number((0,ie.formatUnits)(e,t))}var st={solana:1,ethereum:2,bsc:4,polygon:5,avalanche:6,arbitrum:23,optimism:24,base:30,aptos:22};function R(e){return st[e]}var ve={[1]:2,[56]:4,[137]:5,[43114]:6,[42161]:23,[10]:24,[8453]:30};function Be(e){let t=st[e],n=Object.keys(ve);for(let r of n)if(ve[r]===t)return Number(r);throw new Error(`Unsupported chain: ${e}`)}function Z(e){return ve[e]}var ye=[9,8,0];function We(){return ye.join("_")}function Ne(e){return ye[0]<e[0]?!1:ye[0]>e[0]?!0:ye[1]<e[1]?!1:ye[1]>e[1]||ye[2]>=e[2]}function N(e){return e==="solana"?9:18}function Ke(e){return e==="solana"?9:8}var rn=BigInt(2)**BigInt(64)-BigInt(1);function O(e){if(e<BigInt(0)||e>rn)throw new Error(`Invalid u64: ${e}`);let t=xe.Buffer.alloc(8);return t.writeBigUInt64LE(e),t}var se={value:BigInt(0),deadline:0,v:0,r:`0x${j.SystemProgram.programId.toBuffer().toString("hex")}`,s:`0x${j.SystemProgram.programId.toBuffer().toString("hex")}`};function Le(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}function ce(e,t){return!e||!t?null:e.type==="WH"?t?.solana||null:e.type==="MCTP"||e.type==="SWIFT"?e.toChain==="solana"?t?.solana||null:t?.evm||null:null}function Ge(e){return Object.entries(e).filter(([t,n])=>n!=null&&!Array.isArray(n)).map(([t,n])=>`${encodeURIComponent(t)}=${encodeURIComponent(n)}`).join("&")}async function re(e){if(e.status.toString().startsWith("5")){let t;try{let n=await e.json();n.code&&(n?.message||n?.msg)&&(t={code:n.code,message:n?.message||n?.msg})}catch{t=new Error("Internal server error")}throw t}}async function an(e){let t=e?`?standard=${e.join(",")}`:"",n=await(0,X.default)(`${d.PRICE_URL}/tokens${t}`,{method:"GET",redirect:"follow"});if(await re(n),n.status===200)return await n.json();throw new Error("Cannot fetch Mayan tokens!")}async function sn(e,t=!1,n){let r={chain:e,nonPortal:t,standard:n?n?.join(","):void 0},a=await(0,X.default)(`${d.PRICE_URL}/tokens?${Ge(r)}`);if(await re(a),a.status===200)return(await a.json())[e];throw new Error("Cannot fetch Mayan tokens!")}function ot(e,t={swift:!0,mctp:!0,gasless:!1,onlyDirect:!1}){let{gasDrop:n,referrerBps:r}=e,a=e.slippageBps;a!=="auto"&&!Number.isFinite(a)&&(a=e.slippage*100);let i={...{swift:t.swift!==!1,mctp:t.mctp!==!1,gasless:t.gasless===!0,onlyDirect:t.onlyDirect===!0},solanaProgram:d.MAYAN_PROGRAM_ID,forwarderAddress:d.MAYAN_FORWARDER_CONTRACT,amountIn:Number.isFinite(e.amount)?e.amount:void 0,fromToken:e.fromToken,fromChain:e.fromChain,toToken:e.toToken,toChain:e.toChain,slippageBps:a,referrer:e.referrer,referrerBps:Number.isFinite(r)?r:void 0,gasDrop:Number.isFinite(n)?n:void 0,sdkVersion:We()},s=`${d.PRICE_URL}/quote?`,y=Ge(i);return s+y}async function on(e,t={swift:!0,mctp:!0,gasless:!1,onlyDirect:!1}){let n=ot(e,t),r=await(0,X.default)(n,{method:"GET",redirect:"follow"});await re(r);let a=await r.json();if(r.status!==200&&r.status!==201)throw{code:a?.code||0,message:a?.msg||"Route not found"};if(!Ne(a.minimumSdkVersion))throw{code:9999,message:"Swap SDK is outdated!"};return a.quotes}async function pn(e){let t=await(0,X.default)(`${d.PRICE_URL}/clock/${e}`,{method:"GET",redirect:"follow"});await re(t);let n=await t.json();if(t.status!==200&&t.status!==201)throw n;return n.clock}async function Ue(){let e=await(0,X.default)(`${d.RELAYER_URL}/active-relayers?solanaProgram=${d.MAYAN_PROGRAM_ID}`,{method:"GET",redirect:"follow"});await re(e);let t=await e.json();if(e.status!==200&&e.status!==201)throw t;return t.suggested}async function Te(e){let t=Ge(e),n=await(0,X.default)(`${d.PRICE_URL}/get-swap/solana?${t}`,{method:"GET",redirect:"follow"});await re(n);let r=await n.json();if(n.status!==200&&n.status!==201)throw r;return r}async function Qe(e,t){let n=await(0,X.default)(`${d.EXPLORER_URL}/submit/evm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,signature:t},(r,a)=>typeof a=="bigint"?a.toString():a)});await re(n)}async function He(e){let t=await(0,X.default)(`${d.EXPLORER_URL}/submit/solana`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signedTx:e})});await re(t);let n=await t.json();if(t.status!==200&&t.status!==201)throw n;return n}var te=require("ethers"),fe=require("@solana/web3.js");var pt={_format:"hh-sol-artifact-1",contractName:"MayanSwap",sourceName:"src/MayanSwap.sol",abi:[{inputs:[{internalType:"address",name:"_tokenBridge",type:"address"},{internalType:"address",name:"_weth",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint16",name:"emitterChainId",type:"uint16"},{indexed:!0,internalType:"bytes32",name:"emitterAddress",type:"bytes32"},{indexed:!0,internalType:"uint64",name:"sequence",type:"uint64"}],name:"Redeemed",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"tokenAddr",type:"bytes32"},{internalType:"uint16",name:"tokenChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"sourceAddr",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint64",name:"sequence",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bool",name:"unwrapRedeem",type:"bool"},{internalType:"bool",name:"unwrapRefund",type:"bool"}],internalType:"struct MayanStructs.Swap",name:"s",type:"tuple"}],name:"encodeSwap",outputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],stateMutability:"pure",type:"function"},{inputs:[],name:"getWeth",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRedeemPayload",outputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"uint64",name:"relayerFee",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanStructs.Redeem",name:"r",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeem",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeemAndUnwrap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"}],name:"swap",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"sweepEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"sweepToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"}],name:"wrapAndSwapETH",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{stateMutability:"payable",type:"receive"}]};var le={_format:"hh-sol-artifact-1",contractName:"MayanForwarder",sourceName:"src/MayanForwarder.sol",abi:[{inputs:[{internalType:"address",name:"_guardian",type:"address"},{internalType:"address[]",name:"_swapProtocols",type:"address[]"},{internalType:"address[]",name:"_mayanProtocols",type:"address[]"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"UnsupportedProtocol",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedEth",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"SwapAndForwarded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"tokenIn",type:"address"},{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedEth",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"mayanProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setMayanProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setSwapProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"swapProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],linkReferences:{},deployedLinkReferences:{}};var qe=require("buffer");var x=require("ethers"),L=require("@solana/web3.js");var Ve={_format:"hh-sol-artifact-1",contractName:"MayanCircle",sourceName:"src/MayanCircle.sol",abi:[{inputs:[{internalType:"address",name:"_cctpTokenMessenger",type:"address"},{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"_solanaEmitter",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"CctpReceiveFailed",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidDomain",type:"error"},{inputs:[],name:"InvalidEmitter",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidNonce",type:"error"},{inputs:[],name:"InvalidOrder",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{components:[{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"bytes32",name:"mintRecipient",type:"bytes32"},{internalType:"bytes32",name:"callerAddr",type:"bytes32"}],internalType:"struct MayanCircle.CctpRecipient",name:"recipient",type:"tuple"}],name:"bridgeWithFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint256",name:"redeemFee",type:"uint256"},{components:[{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"bytes32",name:"mintRecipient",type:"bytes32"},{internalType:"bytes32",name:"callerAddr",type:"bytes32"}],internalType:"struct MayanCircle.CctpRecipient",name:"recipient",type:"tuple"}],name:"bridgeWithLockedFee",outputs:[{internalType:"uint64",name:"cctpNonce",type:"uint64"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cctpTokenMessenger",outputs:[{internalType:"contract ITokenMessenger",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"params",type:"tuple"},{components:[{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"bytes32",name:"mintRecipient",type:"bytes32"},{internalType:"bytes32",name:"callerAddr",type:"bytes32"}],internalType:"struct MayanCircle.CctpRecipient",name:"recipient",type:"tuple"}],name:"createOrder",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint64",name:"",type:"uint64"}],name:"feeStorage",outputs:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"redeemFee",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"}],name:"fulfillOrder",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"localDomain",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseFulfillMsg",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"driver",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"uint64",name:"cctpNonce",type:"uint64"}],internalType:"struct MayanCircle.FulfillMsg",name:"fulfillMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeemWithFee",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"redeemWithLockedFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"cctpNonce",type:"uint32"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"refineFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"orderParams",type:"tuple"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"}],internalType:"struct MayanCircle.ExtraParams",name:"extraParams",type:"tuple"}],name:"refund",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"solanaEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm1",type:"bytes"},{internalType:"bytes",name:"encodedVm2",type:"bytes"}],name:"unlockFeeRefined",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}};var we=require("buffer");var H=require("@solana/web3.js");var z=require("buffer"),V=6;function J(e){switch(e){case"ethereum":return 0;case"avalanche":return 1;case"optimism":return 2;case"arbitrum":return 3;case"solana":return 5;case"base":return 6;case"polygon":return 7;default:throw new Error("unsupported chain for cctp")}}function Re(e,t){let n=new H.PublicKey(d.CCTP_CORE_PROGRAM_ID),r=new H.PublicKey(d.CCTP_TOKEN_PROGRAM_ID),[a]=H.PublicKey.findProgramAddressSync([z.Buffer.from("message_transmitter")],n),[o]=H.PublicKey.findProgramAddressSync([z.Buffer.from("sender_authority")],r),[i]=H.PublicKey.findProgramAddressSync([z.Buffer.from("local_token"),e.toBytes()],r),[s]=H.PublicKey.findProgramAddressSync([z.Buffer.from("token_messenger")],r),[y]=H.PublicKey.findProgramAddressSync([z.Buffer.from("token_minter")],r),p=J(t),[c]=H.PublicKey.findProgramAddressSync([z.Buffer.from("remote_token_messenger"),z.Buffer.from(p.toString())],r),[u]=H.PublicKey.findProgramAddressSync([z.Buffer.from("__event_authority")],n),[l]=H.PublicKey.findProgramAddressSync([z.Buffer.from("__event_authority")],r);return{messageTransmitter:a,senderAuthority:o,remoteTokenMessengerKey:c,tokenMessenger:s,tokenMinter:y,eventAuthToken:l,eventAuthCore:u,localToken:i}}function un(e,t,n){let r=Z(Number(n)),a=R(e.fromChain),o=R(e.toChain);if(a!==r)throw new Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${a} !== ${r}`);let i=e.cheaperChain===e.fromChain,s=A(t,o),y=w(e.redeemRelayerFee,V),p=w(e.gasDrop,Math.min(N(e.toChain),8)),c=w(e.effectiveAmountIn,e.fromToken.decimals),u=J(e.toChain);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");let l=e.mctpMayanContract,m,f;if(e.toChain==="solana"){if(i)throw new Error("Cannot lock fee for transfer to solana");let[g]=L.PublicKey.findProgramAddressSync([we.Buffer.from("CALLER")],new L.PublicKey(d.MCTP_PROGRAM_ID)),[P]=L.PublicKey.findProgramAddressSync([we.Buffer.from("MAIN")],new L.PublicKey(d.MCTP_PROGRAM_ID)),k=new L.PublicKey(e.mctpOutputContract),h=_(k,P,!0);m=A(h.toString(),R("solana")),f=A(g.toString(),R("solana"))}else f=A(l,o),i?m=s:m=f;let T=w(e.bridgeFee,N(e.fromChain));return i&&(T=BigInt(0)),{lockFee:i,tokenIn:e.mctpInputContract,amountIn:c,redeemFee:y,gasDrop:p,destAddr:s,recipient:{destDomain:u,mintRecipient:m,callerAddr:f},bridgeFee:T,contractAddress:l}}function ut(e,t,n){let r=un(e,t,n),{contractAddress:a,tokenIn:o,amountIn:i,destAddr:s,lockFee:y,redeemFee:p,gasDrop:c,recipient:u,bridgeFee:l}=r,m=new x.Contract(a,Ve.abi),f,T;return y?f=m.interface.encodeFunctionData("bridgeWithLockedFee",[o,i,c,p,u]):f=m.interface.encodeFunctionData("bridgeWithFee",[o,i,p,c,s,u]),T=(0,x.toBeHex)(l),{to:a,data:f,value:T,_params:r}}function yn(e,t,n,r){let a=Z(Number(r)),o=R(e.fromChain),i=R(e.toChain);if(o!==a)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${o} !== ${a}`);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");let s=e.mctpMayanContract,y,p;if(e.toChain==="solana"){let[h]=L.PublicKey.findProgramAddressSync([we.Buffer.from("CALLER")],new L.PublicKey(d.MCTP_PROGRAM_ID)),[E]=L.PublicKey.findProgramAddressSync([we.Buffer.from("MAIN")],new L.PublicKey(d.MCTP_PROGRAM_ID)),M=new L.PublicKey(e.mctpOutputContract),W=_(M,E,!0);y=A(W.toString(),R("solana")),p=A(h.toString(),R("solana"))}else y=A(s,i),p=A(s,i);let c=J(e.toChain),u=A(t,i),l;n?l=A(n,i):l=A(L.SystemProgram.programId.toString(),R("solana"));let m=w(e.redeemRelayerFee,V),f=w(e.gasDrop,Math.min(N(e.toChain),8)),T=w(e.effectiveAmountIn,e.fromToken.decimals),g=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),P=BigInt(e.deadline64),k=e.toToken.contract===x.ZeroAddress?A(L.SystemProgram.programId.toString(),R("solana")):A(e.toToken.contract,e.toToken.wChainId);return{params:{tokenIn:e.mctpInputContract,amountIn:T,gasDrop:f,destAddr:u,destChain:i,tokenOut:k,minAmountOut:g,deadline:P,redeemFee:m,referrerAddr:l,referrerBps:e.referrerBps||0},recipient:{destDomain:c,mintRecipient:y,callerAddr:p},bridgeFee:w(e.bridgeFee,N(e.fromChain)),contractAddress:s}}function yt(e,t,n,r){let a=yn(e,t,n,r),{contractAddress:o,params:i,bridgeFee:s,recipient:y}=a,c=new x.Contract(o,Ve.abi).interface.encodeFunctionData("createOrder",[i,y]),u=(0,x.toBeHex)(s);return{to:o,data:c,value:u,_params:a}}function $e(e,t,n,r,a){if(e.type!=="MCTP")throw new Error("Quote type is not MCTP");if(!Number.isFinite(Number(r)))throw new Error("Invalid signer chain id");r=Number(r);let o=a||se,i=new x.Contract(d.MAYAN_FORWARDER_CONTRACT,le.abi),s=w(e.bridgeFee,N(e.fromChain)),y=(0,x.toBeHex)(s);if(e.fromToken.contract===e.mctpInputContract)if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");let p=yt(e,t,n,r),c="forwardERC20",u=[e.fromToken.contract,p._params.params.amountIn,o,p._params.contractAddress,p.data];return{data:i.interface.encodeFunctionData(c,u),to:d.MAYAN_FORWARDER_CONTRACT,value:(0,x.toBeHex)(y),chainId:r,_forwarder:{method:c,params:u}}}else{let p=ut(e,t,r),c="forwardERC20",u=[e.fromToken.contract,p._params.amountIn,o,p._params.contractAddress,p.data];return{data:i.interface.encodeFunctionData(c,u),to:d.MAYAN_FORWARDER_CONTRACT,value:(0,x.toBeHex)(y),chainId:r,_forwarder:{method:c,params:u}}}else{let{minMiddleAmount:p,evmSwapRouterAddress:c,evmSwapRouterCalldata:u}=e;if(!p||!c||!u)throw new Error("MCTP swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");let l=yt(e,t,n,r),m=w(e.minMiddleAmount,V);if(e.fromToken.contract===x.ZeroAddress){let f=l._params.params.amountIn;if(f<=s)throw new Error("Amount in is less than bridge fee");s!==BigInt(0)&&(f-=s),y=(0,x.toBeHex)(l._params.params.amountIn);let T="swapAndForwardEth",g=[f,c,u,e.mctpInputContract,m,l._params.contractAddress,l.data];return{data:i.interface.encodeFunctionData(T,g),to:d.MAYAN_FORWARDER_CONTRACT,value:(0,x.toBeHex)(y),chainId:r,_forwarder:{method:T,params:g}}}else{let f="swapAndForwardERC20",T=[e.fromToken.contract,l._params.params.amountIn,o,c,u,e.mctpInputContract,m,l._params.contractAddress,l.data];return{data:i.interface.encodeFunctionData(f,T),to:d.MAYAN_FORWARDER_CONTRACT,value:(0,x.toBeHex)(y),chainId:r,_forwarder:{method:f,params:T}}}}else{let l=ut(e,t,r),m=w(e.minMiddleAmount,V);if(e.fromToken.contract===x.ZeroAddress){let f=l._params.amountIn;if(f<=s)throw new Error("Amount in is less than bridge fee");s!==BigInt(0)&&(f-=s),y=(0,x.toBeHex)(l._params.amountIn);let T="swapAndForwardEth",g=[f,c,u,e.mctpInputContract,m,l._params.contractAddress,l.data];return{data:i.interface.encodeFunctionData(T,g),to:d.MAYAN_FORWARDER_CONTRACT,value:(0,x.toBeHex)(y),chainId:r,_forwarder:{method:T,params:g}}}else{let f="swapAndForwardERC20",T=[e.fromToken.contract,l._params.amountIn,o,c,u,e.mctpInputContract,m,l._params.contractAddress,l.data];return{data:i.interface.encodeFunctionData(f,T),to:d.MAYAN_FORWARDER_CONTRACT,value:(0,x.toBeHex)(y),chainId:r,_forwarder:{method:f,params:T}}}}}}var Q=require("ethers"),ke=require("@solana/web3.js");var ct={_format:"hh-sol-artifact-1",contractName:"MayanSwift",sourceName:"src/MayanSwift.sol",abi:[{inputs:[{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"_solanaEmitter",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DuplicateOrder",type:"error"},{inputs:[],name:"FeesTooHigh",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAmount",type:"error"},{inputs:[],name:"InvalidAuctionMode",type:"error"},{inputs:[],name:"InvalidBpsFee",type:"error"},{inputs:[],name:"InvalidContractSignature",type:"error"},{inputs:[],name:"InvalidDestChain",type:"error"},{inputs:[],name:"InvalidEmitterAddress",type:"error"},{inputs:[],name:"InvalidEmitterChain",type:"error"},{inputs:[],name:"InvalidEvmAddr",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidOrderHash",type:"error"},{inputs:[],name:"InvalidOrderStatus",type:"error"},{inputs:[],name:"InvalidSignature",type:"error"},{inputs:[],name:"InvalidSignatureLength",type:"error"},{inputs:[],name:"InvalidSigner",type:"error"},{inputs:[],name:"InvalidSrcChain",type:"error"},{inputs:[],name:"InvalidWormholeFee",type:"error"},{inputs:[],name:"OrderNotExists",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"SmallAmountIn",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"}],name:"OrderCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderRefunded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderUnlocked",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"canceler",type:"bytes32"}],name:"cancelOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithEth",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes",name:"signedOrderHash",type:"bytes"}],name:"createOrderWithSig",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithToken",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillSimple",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"orders",outputs:[{internalType:"enum MayanSwift.Status",name:"status",type:"uint8"},{internalType:"uint64",name:"amountIn",type:"uint64"},{internalType:"uint16",name:"destChainId",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseFulfillPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"driver",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"}],internalType:"struct MayanSwift.FulfillMsg",name:"fulfillMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRefundPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"bytes32",name:"canceler",type:"bytes32"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwift.RefundMsg",name:"refundMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseUnlockPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],internalType:"struct MayanSwift.UnlockMsg",name:"unlockMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32[]",name:"orderHashes",type:"bytes32[]"}],name:"postBatch",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"refundOrder",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"solanaEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"unlockMsgs",outputs:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockSingle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}};var F=require("@solana/web3.js"),D=require("@solana/buffer-layout");var G=require("buffer");var ee=require("ethers");var I=require("@solana/web3.js");var ae=require("buffer"),U=require("@solana/buffer-layout"),bt=require("js-sha256"),gt=De(require("bs58"));var cn={};function ln(e){return cn[e]??=new I.Connection(e),new I.Connection(e)}async function Ie({trx:e,connection:t,errorChance:n,extraRpcs:r,options:a,rate:o=8}){let i=null,s=0,y=[t].concat(r.map(ln));for(let p=0;p<o;p++){if(i)try{let u=await Promise.any(y.map(l=>l.getSignatureStatus(i)));if(u&&u.value){if(u.value.err){if(s>=n)return{signature:i,serializedTrx:e};s++}else if(u.value.confirmationStatus==="confirmed")return{signature:i,serializedTrx:e}}}catch(u){console.error(u)}let c=y.map(u=>u.sendRawTransaction(e,a));if(!i)try{i=await Promise.any(c)}catch(u){console.error("Transaction not submitted, remaining attempts:",o-p-1,u)}await Le(1e3)}if(!i)throw new Error("Failed to send transaction");return{signature:i,serializedTrx:e}}function $(e,t,n,r,a=new I.PublicKey(d.TOKEN_PROGRAM_ID),o=new I.PublicKey(d.ASSOCIATED_TOKEN_PROGRAM_ID)){let i=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:I.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:I.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new I.TransactionInstruction({keys:i,programId:o,data:ae.Buffer.alloc(0)})}var lt=(0,U.struct)([(0,U.u8)("instruction"),(0,U.blob)(8,"amount")]);function Ye(e,t,n,r,a=new I.PublicKey(d.TOKEN_PROGRAM_ID)){let o=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],i=ae.Buffer.alloc(lt.span);return lt.encode({instruction:4,amount:O(r)},i),new I.TransactionInstruction({keys:o,programId:a,data:i})}var dt=(0,U.struct)([(0,U.u8)("instruction")]);function de(e){let t=[{pubkey:e,isSigner:!1,isWritable:!0}],n=ae.Buffer.alloc(dt.span);return dt.encode({instruction:17},n),new I.TransactionInstruction({keys:t,programId:new I.PublicKey(d.TOKEN_PROGRAM_ID),data:n})}var mt=(0,U.struct)([(0,U.u8)("instruction")]);function Tt(e,t,n,r=new I.PublicKey(d.TOKEN_PROGRAM_ID)){let a=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],o=ae.Buffer.alloc(mt.span);return mt.encode({instruction:9},o),new I.TransactionInstruction({keys:a,programId:r,data:o})}var ft=(0,U.struct)([(0,U.u8)("instruction"),(0,U.blob)(8,"amount")]);function me(e,t,n,r,a=new I.PublicKey(d.TOKEN_PROGRAM_ID)){let o=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],i=ae.Buffer.alloc(ft.span);return ft.encode({instruction:3,amount:O(r)},i),new I.TransactionInstruction({keys:o,programId:a,data:i})}var q=new I.PublicKey("So11111111111111111111111111111111111111112");async function dn(e,t,n,r){let a=r??new I.Connection("https://rpc.ankr.com/solana"),o=_(q,e,!1),{blockhash:i,lastValidBlockHeight:s}=await a.getLatestBlockhash(),y=new I.Transaction({feePayer:e,blockhash:i,lastValidBlockHeight:s}),p=await a.getAccountInfo(o,"finalized");(!p||p.data.length===0)&&y.add($(e,o,e,q)),y.add(I.SystemProgram.transfer({fromPubkey:e,toPubkey:o,lamports:w(t,9)})),y.add(de(o));let c=await n(y);return await Ie({trx:c.serialize(),connection:a,errorChance:1,extraRpcs:[]})}async function mn(e,t,n,r){let a=r??new I.Connection("https://rpc.ankr.com/solana"),o=_(q,e,!1),i=I.Keypair.generate(),{blockhash:s,lastValidBlockHeight:y}=await a.getLatestBlockhash(),p=new I.Transaction({feePayer:e,blockhash:s,lastValidBlockHeight:y}),c=_(q,i.publicKey,!1);p.add($(e,c,i.publicKey,q)),p.add(me(o,c,e,w(t,9))),p.add(Tt(c,e,i.publicKey)),p.partialSign(i);let u=await n(p);return await Ie({trx:u.serialize(),connection:a,errorChance:1,extraRpcs:[]})}function Ae(e){return new I.TransactionInstruction({programId:new I.PublicKey(e.programId),keys:e.accounts.map(t=>({pubkey:new I.PublicKey(t.pubkey),isSigner:t.isSigner,isWritable:t.isWritable})),data:ae.Buffer.from(e.data,"base64")})}async function he(e,t){return(await t.getMultipleAccountsInfo(e.map(r=>new I.PublicKey(r)))).reduce((r,a,o)=>{let i=e[o];if(a){let s=new I.AddressLookupTableAccount({key:new I.PublicKey(i),state:I.AddressLookupTableAccount.deserialize(a.data)});r.push(s)}return r},new Array)}function Se(e,t){let n=Ae(e.swapInstruction),r=e.cleanupInstruction?Ae(e.cleanupInstruction):null,a=e.computeBudgetInstructions?e.computeBudgetInstructions.map(Ae):[],o=e.setupInstructions?e.setupInstructions.map(Ae):[];return{swapInstruction:n,cleanupInstruction:r,computeBudgetInstructions:a,setupInstructions:o,addressLookupTableAddresses:e.addressLookupTableAddresses}}function ze(e){let t=`global:${e}`;return ae.Buffer.from(bt.sha256.digest(t)).slice(0,8)}async function Je(){let e;try{let t=await Ue();e=new I.PublicKey(t)}catch{console.log("Relayer not found, using system program"),e=I.SystemProgram.programId}return e}function je(e,t,n,r){let a=r.jitoAccount||"Cw8CFyM9FkoMi7K7Crf6HNQqf4uEMzpKw6QNghXLvLkY";return new I.Transaction({feePayer:new I.PublicKey(e),blockhash:t,lastValidBlockHeight:n}).add(I.SystemProgram.transfer({fromPubkey:new I.PublicKey(e),toPubkey:new I.PublicKey(a),lamports:r.tipLamports}))}async function Ze(e,t){try{let n=[];for(let a of e)n.push(a.serialize());let r={jsonrpc:"2.0",id:1,method:"sendBundle",params:[n.map(a=>gt.default.encode(a))]};await fetch(t.jitoSendUrl||"https://mainnet.block-engine.jito.wtf/api/v1/bundles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),console.log("Send Jito bundle success")}catch(n){console.error("Send Jito bundle failed",n)}}function Xe(e,t,n,r,a){let i=G.Buffer.alloc(239),s=0,y=R(e.fromChain),p=G.Buffer.from(v(A(t,y)));i.set(p,0),s+=32,i.writeUInt16BE(y,s),s+=2;let c=e.swiftInputContract===ee.ZeroAddress?A(F.SystemProgram.programId.toString(),R("solana")):A(e.swiftInputContract,y),u=G.Buffer.from(v(c));i.set(u,s),s+=32;let l=R(e.toChain),m=G.Buffer.from(v(A(n,l)));i.set(m,s),s+=32,i.writeUInt16BE(l,s),s+=2;let f=e.toToken.contract===ee.ZeroAddress?A(F.SystemProgram.programId.toString(),R("solana")):A(e.toToken.contract,l),T=G.Buffer.from(v(f));i.set(T,s),s+=32,i.writeBigUInt64BE(w(e.minAmountOut,Math.min(e.toToken.decimals,8)),s),s+=8,i.writeBigUInt64BE(w(e.gasDrop,Math.min(N(e.toChain),8)),s),s+=8,i.writeBigUInt64BE(BigInt(e.cancelRelayerFee64),s),s+=8,i.writeBigUInt64BE(BigInt(e.refundRelayerFee64),s),s+=8,i.writeBigUInt64BE(BigInt(e.deadline64),s),s+=8;let g=r?G.Buffer.from(v(A(r,l))):F.SystemProgram.programId.toBuffer();i.set(g,s),s+=32,i.writeUInt8(e.referrerBps,s),s+=1;let P=e.protocolBps;i.writeUInt8(P,s),s+=1,i.writeUInt8(e.swiftAuctionMode,s),s+=1;let k=G.Buffer.from(v(a));if(i.set(k,s),s+=32,s!==239)throw new Error(`Invalid order data size: ${s}`);let h=ee.ethers.keccak256(i);return G.Buffer.from(v(h))}var wt=(0,D.struct)([(0,D.blob)(8,"instruction"),(0,D.blob)(8,"amountInMin"),(0,D.u8)("nativeInput"),(0,D.blob)(8,"feeSubmit"),(0,D.blob)(32,"destAddress"),(0,D.u16)("destinationChain"),(0,D.blob)(32,"tokenOut"),(0,D.blob)(8,"amountOutMin"),(0,D.blob)(8,"gasDrop"),(0,D.blob)(8,"feeCancel"),(0,D.blob)(8,"feeRefund"),(0,D.blob)(8,"deadline"),(0,D.blob)(32,"refAddress"),(0,D.u8)("feeRateRef"),(0,D.u8)("feeRateMayan"),(0,D.u8)("auctionMode"),(0,D.blob)(32,"randomKey")]);function fn(e){let{quote:t}=e,n=t.swiftInputContract===ee.ZeroAddress?q:new F.PublicKey(t.swiftInputContract),r=R(t.toChain);if(r!==t.toToken.wChainId)throw new Error(`Destination chain ID mismatch: ${r} != ${t.toToken.wChainId}`);let a=[{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.relayer,isWritable:!0,isSigner:!0},{pubkey:e.state,isWritable:!0,isSigner:!1},{pubkey:e.stateAccount,isWritable:!0,isSigner:!1},{pubkey:e.relayerAccount,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:new F.PublicKey(d.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:new F.PublicKey(d.TOKEN_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:F.SystemProgram.programId,isWritable:!1,isSigner:!1}],o=G.Buffer.alloc(wt.span),i=e.referrerAddress?G.Buffer.from(v(A(e.referrerAddress,r))):F.SystemProgram.programId.toBuffer(),s=t.fromToken.contract===t.swiftInputContract?t.effectiveAmountIn:t.minMiddleAmount;return wt.encode({instruction:ze("init_order"),amountInMin:O(w(s,t.swiftInputDecimals)),nativeInput:t.swiftInputContract===ee.ZeroAddress?1:0,feeSubmit:O(BigInt(t.submitRelayerFee64)),destAddress:G.Buffer.from(v(A(e.destinationAddress,r))),destinationChain:r,tokenOut:G.Buffer.from(v(A(t.toToken.contract,r))),amountOutMin:O(w(t.minAmountOut,Math.min(t.toToken.decimals,8))),gasDrop:O(w(t.gasDrop,Math.min(N(t.toChain),8))),feeCancel:O(BigInt(t.cancelRelayerFee64)),feeRefund:O(BigInt(t.refundRelayerFee64)),deadline:O(e.deadline),refAddress:i,feeRateRef:t.referrerBps,feeRateMayan:t.protocolBps,auctionMode:t.swiftAuctionMode,randomKey:e.randomKey.toBuffer()},o),new F.TransactionInstruction({keys:a,data:o,programId:new F.PublicKey(d.SWIFT_PROGRAM_ID)})}async function At(e,t,n,r,a,o={}){if(e.type!=="SWIFT")throw new Error("Unsupported quote type for Swift: "+e.type);if(e.toChain==="solana")throw new Error("Unsupported destination chain: "+e.toChain);let i=o.allowSwapperOffCurve||!1,s=[],y=[],p=[];p.push(d.LOOKUP_TABLE);let c=new F.PublicKey(d.SWIFT_PROGRAM_ID),u=new F.PublicKey(t),l=F.Keypair.generate();if(!Number(e.deadline64))throw new Error("Swift mode requires a timeout");let m=BigInt(e.deadline64),f=Xe(e,t,n,r,l.publicKey.toBuffer().toString("hex")),[T]=F.PublicKey.findProgramAddressSync([G.Buffer.from("STATE_SOURCE"),f],c),g=_(new F.PublicKey(e.swiftInputContract),T,!0),P=e.swiftInputContract===ee.ZeroAddress?q:new F.PublicKey(e.swiftInputContract),k=e.gasless?new F.PublicKey(e.relayer):u,h=_(P,k,!1);if(e.fromToken.contract===e.swiftInputContract)e.suggestedPriorityFee>0&&s.push(F.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),s.push($(k,g,T,P)),e.swiftInputContract===ee.ZeroAddress?s.push(F.SystemProgram.transfer({fromPubkey:u,toPubkey:g,lamports:w(e.effectiveAmountIn,e.fromToken.decimals)}),de(g)):s.push(me(_(P,u,i),g,u,w(e.effectiveAmountIn,e.fromToken.decimals)));else{let E=await Te({minMiddleAmount:e.minMiddleAmount,middleToken:e.swiftInputContract,userWallet:t,slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn:e.effectiveAmountIn,depositMode:e.gasless?"SWIFT_GASLESS":"SWIFT",orderHash:`0x${f.toString("hex")}`}),M=Se(E,a);s.push(...M.computeBudgetInstructions),M.setupInstructions&&s.push(...M.setupInstructions),s.push(M.swapInstruction),M.cleanupInstruction&&s.push(M.cleanupInstruction),p.push(...M.addressLookupTableAddresses)}return s.push(fn({quote:e,state:T,trader:u,stateAccount:g,randomKey:l.publicKey,relayerAccount:h,relayer:k,destinationAddress:n,deadline:m,referrerAddress:r})),y=await he(p,a),{instructions:s,signers:[],lookupTables:y}}function It(e,t,n,r,a){let o=Z(Number(a)),i=R(e.fromChain),s=R(e.toChain);if(i!==o)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${i} !== ${o}`);if(!e.swiftMayanContract)throw new Error("SWIFT contract address is missing");if(e.toToken.wChainId!==s)throw new Error(`Destination chain ID mismatch: ${s} != ${e.toToken.wChainId}`);let y=e.swiftMayanContract;if(!Number(e.deadline64))throw new Error("Swift order requires timeout");let p=BigInt(e.deadline64),c=e.swiftInputContract,u=w(e.effectiveAmountIn,e.fromToken.decimals),l;r?l=A(r,s):l=A(ke.SystemProgram.programId.toString(),1);let m=A(ke.Keypair.generate().publicKey.toString(),1),f=e.toToken.contract===Q.ZeroAddress?A(ke.SystemProgram.programId.toString(),1):A(e.toToken.contract,s),T=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),g=w(e.gasDrop,Math.min(8,N(e.toChain))),P=A(n,s),k={trader:A(t,i),tokenOut:f,minAmountOut:T,gasDrop:g,cancelFee:BigInt(e.cancelRelayerFee64),refundFee:BigInt(e.refundRelayerFee64),deadline:p,destAddr:P,destChainId:s,referrerAddr:l,referrerBps:e.referrerBps||0,auctionMode:e.swiftAuctionMode,random:m};return{contractAddress:y,tokenIn:c,amountIn:u,order:k}}function ht(e,t,n,r,a,o){if(e.type!=="SWIFT")throw new Error("Quote type is not SWIFT");if(!Number.isFinite(Number(a)))throw new Error("Invalid signer chain id");if(!Number(e.deadline64))throw new Error("Swift order requires timeout");a=Number(a);let i=o||se,s=new Q.Contract(d.MAYAN_FORWARDER_CONTRACT,le.abi),{tokenIn:y,amountIn:p,order:c,contractAddress:u}=It(e,t,n,r,a),l,m=new Q.Contract(u,ct.abi);e.swiftInputContract===Q.ZeroAddress?l=m.interface.encodeFunctionData("createOrderWithEth",[c]):l=m.interface.encodeFunctionData("createOrderWithToken",[y,p,c]);let f,T,g;if(e.fromToken.contract===e.swiftInputContract)e.fromToken.contract===Q.ZeroAddress?(f="forwardEth",T=[u,l],g=(0,Q.toBeHex)(p)):(f="forwardERC20",T=[y,p,i,u,l],g=(0,Q.toBeHex)(0));else{let{evmSwapRouterAddress:k,evmSwapRouterCalldata:h}=e;if(!e.minMiddleAmount||!k||!h)throw new Error("Swift swap requires middle amount, router address and calldata");let E=e.fromToken.contract,M=w(e.minMiddleAmount,e.swiftInputDecimals);e.fromToken.contract===Q.ZeroAddress?(f="swapAndForwardEth",T=[p,k,h,e.swiftInputContract,M,u,l],g=(0,Q.toBeHex)(p)):(f="swapAndForwardERC20",T=[E,p,i,k,h,e.swiftInputContract,M,u,l],g=(0,Q.toBeHex)(0))}return{data:s.interface.encodeFunctionData(f,T),to:d.MAYAN_FORWARDER_CONTRACT,value:g,chainId:a,_forwarder:{method:f,params:T}}}function bn(e,t,n){if(!Number.isFinite(Number(n)))throw new Error("Invalid signer chain id");let r=w(e.effectiveAmountIn,e.swiftInputDecimals),a=BigInt(e.submitRelayerFee64);return{domain:{name:"Mayan Swift",chainId:Number(n),verifyingContract:e.swiftMayanContract},types:{CreateOrder:[{name:"OrderId",type:"bytes32"},{name:"InputAmount",type:"uint256"},{name:"SubmissionFee",type:"uint256"}]},value:{OrderId:t,InputAmount:r-a,SubmissionFee:a}}}function St(e,t,n,r,a,o){if(e.type!=="SWIFT")throw new Error("Quote type is not SWIFT");if(!e.gasless)throw new Error("Quote does not support gasless");if(!Number.isFinite(Number(a)))throw new Error("Invalid signer chain id");if(!Number(e.deadline64))throw new Error("Swift order requires timeout");if(e.fromToken.contract!==e.swiftInputContract)throw new Error("Swift gasless order creation does not support source swap");let{tokenIn:i,amountIn:s,order:y,contractAddress:p}=It(e,t,n,r,Number(a)),c=R(e.fromChain),l=`0x${Xe(e,t,n,r,y.random).toString("hex")}`,m=bn(e,l,a);return{permitParams:o,orderParams:{...y,sourceChainId:c,amountIn:s,tokenIn:i,submissionFee:BigInt(e.submitRelayerFee64)},orderHash:l,orderTypedData:m}}function gn(e,t,n,r,a,o){let i=new fe.PublicKey(d.MAYAN_PROGRAM_ID),[s]=fe.PublicKey.findProgramAddressSync([qe.Buffer.from("MAIN")],i),y=_(new fe.PublicKey(e.fromToken.mint),s,!0),p=w(e.effectiveAmountIn,e.fromToken.decimals),c=A(y.toString(),1),u=A(d.AUCTION_PROGRAM_ID,1),l;n?l=A(n,1):l=A(fe.SystemProgram.programId.toString(),1);let m=Z(Number(a)),f=R(e.fromChain),T=R(e.toChain);if(f!==m)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${f} !== ${m}`);let g=e.whMayanContract,P={mayanAddr:c,mayanChainId:1,destAddr:A(t,T),destChainId:T,auctionAddr:u,referrer:l,refundAddr:A(r,m)},k=e.toToken.contract===te.ZeroAddress,h={transferDeadline:BigInt(e.deadline64),swapDeadline:BigInt(e.deadline64),amountOutMin:w(e.minAmountOut,Math.min(8,e.toToken.decimals)),gasDrop:w(e.gasDrop,Math.min(8,N(e.toChain))),unwrap:k,customPayload:o?`0x${qe.Buffer.from(o).toString("hex")}`:"0x"},E={swapFee:w(e.swapRelayerFee,Math.min(8,e.fromToken.decimals)),redeemFee:w(e.redeemRelayerFee,Math.min(8,e.toToken.decimals)),refundFee:w(e.refundRelayerFee,Math.min(8,e.fromToken.decimals))},M=A(e.toToken.realOriginContractAddress,e.toToken.realOriginChainId),W=w(e.bridgeFee,18);return{amountIn:p,tokenIn:e.fromToken.contract,tokenOut:M,tokenOutWChainId:e.toToken.realOriginChainId,criteria:h,recipient:P,relayerFees:E,contractAddress:g,bridgeFee:W}}function Oe(e,t,n,r,a,o,i,s){let y=Z(Number(o)),p=R(e.fromChain);if(p!==y)throw new Error(`Signer chain id(${Number(o)}) and quote from chain are not same! ${p} !== ${y}`);let c=ce(e,r);if(e.type==="MCTP")return $e(e,n,c,o,s);if(e.type==="SWIFT")return ht(e,t,n,c,o,s);if(e.type!="WH")throw new Error("Unsupported quote type");if(!Number(e.deadline64))throw new Error("WH mode requires a timeout");let{relayerFees:u,recipient:l,tokenOut:m,tokenOutWChainId:f,criteria:T,tokenIn:g,amountIn:P,contractAddress:k,bridgeFee:h}=gn(e,n,c,a,o,i),E=new te.Contract(d.MAYAN_FORWARDER_CONTRACT,le.abi),M=new te.Contract(k,pt.abi),W,pe,Y,be=s||se;if(g===te.ZeroAddress){let ue=M.interface.encodeFunctionData("wrapAndSwapETH",[u,l,m,f,T]);W="forwardEth",pe=[k,ue],Y=(0,te.toBeHex)(P)}else{let ue=M.interface.encodeFunctionData("swap",[u,l,m,f,T,g,P]);W="forwardERC20",pe=[g,P,be,k,ue],Y=(0,te.toBeHex)(h)}let Pe=E.interface.encodeFunctionData(W,pe);return{to:d.MAYAN_FORWARDER_CONTRACT,data:Pe,value:Y,chainId:o,_forwarder:{method:W,params:pe}}}async function Tn(e,t,n,r,a,o,i,s){if(!a.provider)throw new Error("No provider found for signer");let y=await a.getAddress();if(y.toLowerCase()!==t.toLowerCase())throw new Error("Signer address does not match swapper address");let p=Number((await a.provider.getNetwork()).chainId);if(e.type==="SWIFT"&&e.gasless){let u=ce(e,r),l=St(e,t,n,u,p,o),m=await a.signTypedData(l.orderTypedData.domain,l.orderTypedData.types,l.orderTypedData.value);return await Qe(l,m),l.orderHash}let c=Oe(e,t,n,r,y,p,s,o);if(delete c._forwarder,i?.gasPrice&&(c.gasPrice=i.gasPrice),i?.maxFeePerGas&&(c.maxFeePerGas=i.maxFeePerGas),i?.maxPriorityFeePerGas&&(c.maxPriorityFeePerGas=i.maxPriorityFeePerGas),i?.gasLimit)c.gasLimit=i.gasLimit;else if(e.type==="MCTP"||e.type==="SWIFT"){let u=await a.estimateGas(c);c.gasLimit=String(BigInt(String(u))*BigInt(110)/BigInt(100))}return c.chainId=Be(e.fromChain),a.sendTransaction(c)}async function wn(e,t,n,r,a){let o=await n.getAddress(),i=e.toChain==="solana"?"ENsytooJVSZyNHbxvueUeX8Am8gcNqPivVVE8USCBiy5":"0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",s=Number((await n.provider.getNetwork()).chainId);if(e.type==="SWIFT"&&e.gasless)return BigInt(0);let y=Oe(e,t,i,null,o,s,a,r);delete y._forwarder;let p=await n.estimateGas(y);return p=BigInt(String(p)),e.type==="MCTP"||e.type==="SWIFT"?p*BigInt(110)/BigInt(100):p}async function An(e,t,n,r){let a="0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",o=e.toChain==="solana"?"ENsytooJVSZyNHbxvueUeX8Am8gcNqPivVVE8USCBiy5":"0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",i=e?.fromToken?.chainId;if(e.type==="SWIFT"&&e.gasless)return BigInt(0);let s=Oe(e,a,o,null,a,i,r,n);return delete s._forwarder,t.estimateGas(s)}var C=require("@solana/web3.js"),B=require("@solana/buffer-layout");var ne=require("buffer");var Ee=require("ethers");var b=require("@solana/web3.js"),S=require("@solana/buffer-layout");var K=require("buffer");var oe=require("@solana/web3.js");var Ce=require("buffer");function kt(e){let t=new oe.PublicKey(d.WORMHOLE_PROGRAM_ID),n=new oe.PublicKey(e),[r]=oe.PublicKey.findProgramAddressSync([Ce.Buffer.from("Bridge")],t),[a]=oe.PublicKey.findProgramAddressSync([Ce.Buffer.from("emitter")],n),[o]=oe.PublicKey.findProgramAddressSync([Ce.Buffer.from("Sequence"),a.toBuffer()],t),[i]=oe.PublicKey.findProgramAddressSync([Ce.Buffer.from("fee_collector")],t);return{bridgeConfig:r,sequenceKey:o,feeCollector:i,emitter:a}}var Ct=(0,S.struct)([(0,S.u8)("instruction"),(0,S.u32)("destinationDomain")]);function In(e,t,n,r,a){let o=new b.PublicKey(d.WORMHOLE_PROGRAM_ID),i=new b.PublicKey(d.TOKEN_PROGRAM_ID),s=new b.PublicKey(d.CCTP_CORE_PROGRAM_ID),y=new b.PublicKey(d.CCTP_TOKEN_PROGRAM_ID),p=new b.PublicKey(d.MCTP_PROGRAM_ID),c=new b.PublicKey(r),u=new b.PublicKey(n),l=_(u,e,!0),m;a&&a>BigInt(0)?m=_(u,c,!1):m=e;let f=Re(u,t),T=kt(d.MCTP_PROGRAM_ID),g=b.Keypair.generate(),P=b.Keypair.generate(),k=[{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:f.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:l,isWritable:!0,isSigner:!1},{pubkey:f.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:f.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:f.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:f.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:f.localToken,isWritable:!0,isSigner:!1},{pubkey:u,isWritable:!0,isSigner:!1},{pubkey:g.publicKey,isWritable:!0,isSigner:!0},{pubkey:f.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:T.emitter,isWritable:!1,isSigner:!1},{pubkey:T.sequenceKey,isWritable:!0,isSigner:!1},{pubkey:P.publicKey,isWritable:!0,isSigner:!0},{pubkey:T.bridgeConfig,isWritable:!0,isSigner:!1},{pubkey:T.feeCollector,isWritable:!0,isSigner:!1},{pubkey:c,isWritable:!0,isSigner:!0},{pubkey:m,isWritable:!0,isSigner:!1},{pubkey:b.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:b.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:b.SystemProgram.programId,isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!1,isSigner:!1}],h=K.Buffer.alloc(Ct.span);return Ct.encode({instruction:11,destinationDomain:J(t)},h),{instruction:new b.TransactionInstruction({keys:k,data:h,programId:p}),signers:[g,P]}}var Pt=(0,S.struct)([(0,S.u8)("instruction"),(0,S.u32)("destinationDomain")]);function hn(e,t,n,r,a){let o=[],i=new b.PublicKey(d.TOKEN_PROGRAM_ID),s=new b.PublicKey(d.CCTP_CORE_PROGRAM_ID),y=new b.PublicKey(d.CCTP_TOKEN_PROGRAM_ID),p=new b.PublicKey(d.MCTP_PROGRAM_ID),c=new b.PublicKey(r),u=new b.PublicKey(n),l=_(u,e,!0),m=Re(u,t),f=b.Keypair.generate(),[T]=b.PublicKey.findProgramAddressSync([K.Buffer.from("FEESTATE"),u.toBuffer(),f.publicKey.toBytes()],p),g;a&&a>BigInt(0)?g=_(u,c,!1):g=e;let P=_(u,T,!0);o.push($(c,P,T,u));let k=[{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:m.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:l,isWritable:!0,isSigner:!1},{pubkey:m.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:m.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:m.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:m.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:m.localToken,isWritable:!0,isSigner:!1},{pubkey:u,isWritable:!0,isSigner:!1},{pubkey:f.publicKey,isWritable:!0,isSigner:!0},{pubkey:m.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:T,isWritable:!0,isSigner:!1},{pubkey:P,isWritable:!0,isSigner:!1},{pubkey:c,isWritable:!0,isSigner:!0},{pubkey:g,isWritable:!0,isSigner:!1},{pubkey:b.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:b.SystemProgram.programId,isWritable:!1,isSigner:!1}],h=K.Buffer.alloc(Pt.span);Pt.encode({instruction:12,destinationDomain:J(t)},h);let E=new b.TransactionInstruction({keys:k,data:h,programId:p});return o.push(E),{instructions:o,signer:f}}var Mt=(0,S.struct)([(0,S.u8)("instruction"),(0,S.u32)("destinationDomain")]);function Sn(e,t,n,r,a){let o=new b.PublicKey(d.TOKEN_PROGRAM_ID),i=new b.PublicKey(d.CCTP_CORE_PROGRAM_ID),s=new b.PublicKey(d.CCTP_TOKEN_PROGRAM_ID),y=new b.PublicKey(d.MCTP_PROGRAM_ID),p=new b.PublicKey(d.MAYAN_PROGRAM_ID),c=new b.PublicKey(r),u=new b.PublicKey(n),l=_(u,e,!0),m=Re(u,t),f=b.Keypair.generate(),[T]=b.PublicKey.findProgramAddressSync([K.Buffer.from("SWAP"),e.toBuffer()],y),[g]=b.PublicKey.findProgramAddressSync([K.Buffer.from("MAYANFEE")],p),P;a&&a>BigInt(0)?P=_(u,c,!1):P=e;let k=[{pubkey:T,isWritable:!0,isSigner:!1},{pubkey:g,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!0,isSigner:!0},{pubkey:P,isWritable:!0,isSigner:!1},{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:m.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:l,isWritable:!0,isSigner:!1},{pubkey:m.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:m.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:m.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:m.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:m.localToken,isWritable:!0,isSigner:!1},{pubkey:u,isWritable:!0,isSigner:!1},{pubkey:f.publicKey,isWritable:!0,isSigner:!0},{pubkey:m.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:b.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:b.SystemProgram.programId,isWritable:!1,isSigner:!1}],h=K.Buffer.alloc(Mt.span);return Mt.encode({instruction:42,destinationDomain:J(t)},h),{instruction:new b.TransactionInstruction({keys:k,data:h,programId:y}),signer:f}}var Rt=(0,S.struct)([(0,S.u8)("instruction"),(0,S.blob)(32,"destAddress"),(0,S.blob)(8,"amountInMin"),(0,S.blob)(8,"gasDrop"),(0,S.blob)(8,"feeRedeem"),(0,S.blob)(8,"feeSolana"),(0,S.u32)("destinationDomain"),(0,S.u16)("destinationChain"),(0,S.u8)("mode")]);function Ot(e){if(e.mode!=="WITH_FEE"&&e.mode!=="LOCK_FEE")throw new Error("Invalid mode: "+e.mode);let t=new b.PublicKey(e.swapperAddress),n=new b.PublicKey(e.mintAddress),r=_(n,e.ledger,!0),a=J(e.toChain),o=R(e.toChain),i=K.Buffer.from(v(A(e.destinationAddress,o))),s=O(w(e.amountInMin,V)),y=O(w(e.gasDrop,Math.min(N(e.toChain),8))),p=O(w(e.feeRedeem,V)),c=O(e.feeSolana),u=e.referrerAddress?K.Buffer.from(v(A(e.referrerAddress,o))):b.SystemProgram.programId.toBuffer(),l=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:e.randomKey,isWritable:!1,isSigner:!1},{pubkey:b.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:b.SystemProgram.programId,isWritable:!1,isSigner:!1},{pubkey:new b.PublicKey(u),isWritable:!1,isSigner:!1}],m=K.Buffer.alloc(Rt.span);return Rt.encode({instruction:40,destAddress:i,amountInMin:s,gasDrop:y,feeRedeem:p,feeSolana:c,destinationDomain:a,destinationChain:o,mode:e.mode==="WITH_FEE"?1:2},m),new b.TransactionInstruction({keys:l,data:m,programId:new b.PublicKey(d.MCTP_PROGRAM_ID)})}var Et=(0,S.struct)([(0,S.u8)("instruction"),(0,S.blob)(32,"destAddress"),(0,S.blob)(8,"amountInMin"),(0,S.blob)(8,"gasDrop"),(0,S.blob)(8,"feeRedeem"),(0,S.blob)(8,"feeSolana"),(0,S.u32)("destinationDomain"),(0,S.u16)("destinationChain"),(0,S.u8)("mode"),(0,S.blob)(32,"tokenOut"),(0,S.blob)(32,"refAddress"),(0,S.blob)(8,"amountOutMin"),(0,S.blob)(8,"deadline"),(0,S.u8)("feeRateRef")]);function _t(e){let t=new b.PublicKey(e.swapperAddress),n=new b.PublicKey(e.mintAddress),r=_(n,e.ledger,!0),a=J(e.toChain),o=R(e.toChain),i=K.Buffer.from(v(A(e.destinationAddress,o))),s=O(w(e.amountInMin,V)),y=O(w(e.gasDrop,Math.min(N(e.toChain),8))),p=O(w(e.feeRedeem,V)),c=O(e.feeSolana),u=K.Buffer.from(v(A(e.tokenOut,o))),l=e.referrerAddress?K.Buffer.from(v(A(e.referrerAddress,o))):b.SystemProgram.programId.toBuffer(),m=O(w(e.amountOutMin,Math.min(8,e.tokenOutDecimals))),f=O(e.deadline),T=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:e.randomKey,isWritable:!1,isSigner:!1},{pubkey:b.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:b.SystemProgram.programId,isWritable:!1,isSigner:!1}],g=K.Buffer.alloc(Et.span);return Et.encode({instruction:41,destAddress:i,amountInMin:s,gasDrop:y,feeRedeem:p,feeSolana:c,destinationDomain:a,destinationChain:o,mode:3,tokenOut:u,refAddress:l,amountOutMin:m,deadline:f,feeRateRef:e.feeRateRef},g),new b.TransactionInstruction({keys:T,data:g,programId:new b.PublicKey(d.MCTP_PROGRAM_ID)})}async function et(e,t,n,r,a,o={}){let i=o?.forceSkipCctpInstructions||!1,s=o?.allowSwapperOffCurve||!1;if(e.toChain==="solana")throw new Error("Unsupported destination chain: "+e.toChain);let y=[],p=[],c=[],u=[];y.push(d.LOOKUP_TABLE);let l=new b.PublicKey(d.MCTP_PROGRAM_ID),m=new b.PublicKey(t),f=b.Keypair.generate(),T=e.deadline64?BigInt(e.deadline64):BigInt(0);if(e.hasAuction&&!Number(e.deadline64))throw new Error("Swap mode requires a timeout");let[g]=b.PublicKey.findProgramAddressSync([K.Buffer.from("LEDGER"),m.toBytes(),f.publicKey.toBytes()],l),P=_(new b.PublicKey(e.mctpInputContract),g,!0),k=e.cheaperChain==="solana"?"LOCK_FEE":"WITH_FEE";if(e.fromToken.contract===e.mctpInputContract){let h=BigInt(i?e.solanaRelayerFee64:0);if(e.suggestedPriorityFee>0&&p.push(b.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),p.push($(m,P,g,new b.PublicKey(e.mctpInputContract))),p.push(me(_(new b.PublicKey(e.mctpInputContract),m,s),P,m,w(e.effectiveAmountIn,V))),e.hasAuction){if(p.push(_t({ledger:g,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:f.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:h,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin:e.effectiveAmountIn,tokenOut:e.toToken.contract,tokenOutDecimals:e.toToken.decimals,referrerAddress:r,amountOutMin:e.minAmountOut,deadline:T,feeRateRef:e.referrerBps})),!i){let{instruction:E,signer:M}=Sn(g,e.toChain,e.mctpInputContract,t,h);p.push(E),c.push(M)}}else if(p.push(Ot({ledger:g,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:f.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:h,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin:e.effectiveAmountIn,mode:k,referrerAddress:r})),!i)if(k==="WITH_FEE"){let{instruction:E,signers:M}=In(g,e.toChain,e.mctpInputContract,t,h);p.push(E),c.push(...M)}else{let{instructions:E,signer:M}=hn(g,e.toChain,e.mctpInputContract,t,h);p.push(...E),c.push(M)}}else{let h=BigInt(e.solanaRelayerFee64),E=await Te({minMiddleAmount:e.minMiddleAmount,middleToken:e.mctpInputContract,userWallet:t,userLedger:g.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn:e.effectiveAmountIn,depositMode:e.hasAuction?"SWAP":k}),M=Se(E,a);p.push(...M.computeBudgetInstructions),M.setupInstructions&&p.push(...M.setupInstructions),p.push(M.swapInstruction),M.cleanupInstruction&&p.push(M.cleanupInstruction),y.push(...M.addressLookupTableAddresses),e.hasAuction?p.push(_t({ledger:g,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:f.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:h,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin:e.minMiddleAmount,tokenOut:e.toToken.contract,tokenOutDecimals:e.toToken.decimals,referrerAddress:r,amountOutMin:e.minAmountOut,deadline:T,feeRateRef:e.referrerBps})):p.push(Ot({ledger:g,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:f.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:h,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin:e.minMiddleAmount,mode:k,referrerAddress:r}))}return u=await he(y,a),{instructions:p,signers:c,lookupTables:u}}var kn=420,Ft=(0,B.struct)([(0,B.u8)("instruction"),(0,B.u8)("stateNonce"),(0,B.blob)(8,"amount"),(0,B.blob)(8,"minAmountOut"),(0,B.blob)(8,"deadline"),(0,B.blob)(8,"feeSwap"),(0,B.blob)(8,"feeReturn"),(0,B.blob)(8,"feeCancel"),(0,B.blob)(8,"gasDrop"),(0,B.u16)("destinationChain"),(0,B.blob)(32,"destinationAddress"),(0,B.u8)("unwrapRedeem"),(0,B.u8)("unwrapRefund"),(0,B.u8)("mayanFeeNonce"),(0,B.u8)("referrerFeeNonce")]);async function Dt(e,t,n,r,a,o={}){let i=ce(e,r),s=a??new C.Connection("https://rpc.ankr.com/solana");if(e.type==="MCTP")return et(e,t,n,i,s,o);if(e.type==="SWIFT")return At(e,t,n,i,s,o);let y=[],p=new C.PublicKey(d.MAYAN_PROGRAM_ID),c=new C.PublicKey(d.TOKEN_PROGRAM_ID),u=new C.PublicKey(t),l=new C.PublicKey(d.AUCTION_PROGRAM_ID);e.suggestedPriorityFee>0&&y.push(C.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee}));let m;i?m=new C.PublicKey(i):m=C.SystemProgram.programId;let[f,T]=C.PublicKey.findProgramAddressSync([ne.Buffer.from("MAYANFEE")],p),[g,P]=C.PublicKey.findProgramAddressSync([ne.Buffer.from("REFERRERFEE"),m.toBuffer()],p),k=C.Keypair.generate(),h=C.Keypair.generate(),[E,M]=C.PublicKey.findProgramAddressSync([ne.Buffer.from("V2STATE"),ne.Buffer.from(k.publicKey.toBytes()),ne.Buffer.from(h.publicKey.toBytes())],p),W=new C.PublicKey(e.fromToken.mint),pe=new C.PublicKey(e.toToken.mint),Y=_(W,u),be=_(W,E,!0),[[Pe,ue],vt,xt]=await Promise.all([s.getMultipleAccountsInfo([Y,be],"finalized"),s.getMinimumBalanceForRentExemption(kn),Je()]);(!Pe||Pe.data.length===0)&&y.push($(u,Y,u,W)),(!ue||ue.data.length===0)&&y.push($(u,be,E,W)),e.fromToken.contract===Ee.ZeroAddress&&(y.push(C.SystemProgram.transfer({fromPubkey:u,toPubkey:Y,lamports:w(e.effectiveAmountIn,9)})),y.push(de(Y)));let tt=w(e.effectiveAmountIn,e.mintDecimals.from),ge=C.Keypair.generate();y.push(Ye(Y,ge.publicKey,u,tt)),y.push(C.SystemProgram.transfer({fromPubkey:u,toPubkey:ge.publicKey,lamports:vt}));let Bt=[{pubkey:ge.publicKey,isWritable:!1,isSigner:!0},{pubkey:k.publicKey,isWritable:!1,isSigner:!0},{pubkey:h.publicKey,isWritable:!1,isSigner:!0},{pubkey:E,isWritable:!0,isSigner:!1},{pubkey:Y,isWritable:!0,isSigner:!1},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:be,isWritable:!0,isSigner:!1},{pubkey:W,isWritable:!1,isSigner:!1},{pubkey:pe,isWritable:!1,isSigner:!1},{pubkey:l,isWritable:!1,isSigner:!1},{pubkey:m,isWritable:!1,isSigner:!1},{pubkey:f,isWritable:!1,isSigner:!1},{pubkey:g,isWritable:!1,isSigner:!1},{pubkey:ge.publicKey,isWritable:!0,isSigner:!0},{pubkey:xt,isWritable:!1,isSigner:!1},{pubkey:C.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:C.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:C.SystemProgram.programId,isWritable:!1,isSigner:!1}],_e=R(e.toChain);if(_e===1){let Fe=await s.getAccountInfo(new C.PublicKey(n));if(Fe&&Fe.owner&&Fe.owner.equals(c))throw new Error("Destination address is not about token account. It should be a owner address")}let Wt=ne.Buffer.from(v(A(n,_e))),Nt=w(e.minAmountOut,e.mintDecimals.to),Kt=w(e.swapRelayerFee,e.mintDecimals.from),Lt=w(e.redeemRelayerFee,e.mintDecimals.to),Gt=w(e.refundRelayerFee,e.mintDecimals.from),Ut=w(e.gasDrop,Ke(e.toChain)),Qt=e.toToken.contract===Ee.ZeroAddress,Ht=e.fromToken.contract===Ee.ZeroAddress;if(!Number(e.deadline64))throw new Error("Deadline is not valid");let Vt=BigInt(e.deadline64),nt=ne.Buffer.alloc(Ft.span),$t={instruction:101,stateNonce:M,amount:O(tt),minAmountOut:O(Nt),deadline:O(Vt),feeSwap:O(Kt),feeReturn:O(Lt),feeCancel:O(Gt),gasDrop:O(Ut),destinationChain:_e,destinationAddress:Wt,unwrapRedeem:Qt?1:0,unwrapRefund:Ht?1:0,mayanFeeNonce:T,referrerFeeNonce:P};Ft.encode($t,nt);let Yt=new C.TransactionInstruction({keys:Bt,data:nt,programId:p});return y.push(Yt),{instructions:y,signers:[ge,k,h],lookupTables:[]}}async function Cn(e,t,n,r,a,o,i,s,y,p){let c=o??new C.Connection("https://rpc.ankr.com/solana"),{instructions:u,signers:l,lookupTables:m}=await Dt(e,t,n,r,c,p),f=new C.PublicKey(t),T=e.gasless?new C.PublicKey(e.relayer):f,{blockhash:g,lastValidBlockHeight:P}=await o.getLatestBlockhash(),k=C.MessageV0.compile({instructions:u,payerKey:T,recentBlockhash:g,addressLookupTableAccounts:m}),h=new C.VersionedTransaction(k);h.sign(l);let E;if(!e.gasless&&y&&y.tipLamports>0&&y.signAllTransactions){let M=je(t,g,P,y),W=await y.signAllTransactions([h,M]);E=W[0],Ze(W,y)}else E=await a(h);if(e.gasless){let M=ne.Buffer.from(E.serialize()).toString("base64"),{orderHash:W}=await He(M);return{signature:W,serializedTrx:null}}return await Ie({trx:E.serialize(),connection:c,extraRpcs:i??[],errorChance:2,options:s})}0&&(module.exports={ZeroPermit,addresses,checkSdkVersionSupport,createApproveInstruction,createAssociatedTokenAccountInstruction,createCloseAccountInstruction,createMctpFromSolanaInstructions,createSplTransferInstruction,createSwapFromSolanaInstructions,createSyncNativeInstruction,decentralizeClientSwapInstructions,decideRelayer,deserializeInstructionInfo,estimateQuoteRequiredGas,estimateQuoteRequiredGasAprox,fetchAllTokenList,fetchQuote,fetchTokenList,generateFetchQuoteUrl,getAddressLookupTableAccounts,getAmountOfFractionalAmount,getAnchorInstructionData,getAssociatedTokenAddress,getCurrentChainTime,getDisplayAmount,getEvmChainIdByName,getGasDecimal,getGasDecimalsInSolana,getJitoTipTransfer,getMctpFromEvmTxPayload,getQuoteSuitableReferrerAddress,getSafeU64Blob,getSdkVersion,getSuggestedRelayer,getSwapFromEvmTxPayload,getSwapSolana,getWormholeChainIdById,getWormholeChainIdByName,hexToUint8Array,isValidAptosType,nativeAddressToHexString,sendJitoBundle,solMint,submitSwiftEvmSwap,submitSwiftSolanaSwap,submitTransactionWithRetry,swapFromEvm,swapFromSolana,unwrapSol,wait,wrapSol});
