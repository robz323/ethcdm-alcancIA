var _n=Object.defineProperty,vn=Object.defineProperties;var Dn=Object.getOwnPropertyDescriptors;var st=Object.getOwnPropertySymbols;var Sr=Object.prototype.hasOwnProperty,Lr=Object.prototype.propertyIsEnumerable;var Ir=(e,t,r)=>t in e?_n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Y=(e,t)=>{for(var r in t||(t={}))Sr.call(t,r)&&Ir(e,r,t[r]);if(st)for(var r of st(t))Lr.call(t,r)&&Ir(e,r,t[r]);return e},te=(e,t)=>vn(e,Dn(t));var at=(e,t)=>{var r={};for(var n in e)Sr.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&st)for(var n of st(e))t.indexOf(n)<0&&Lr.call(e,n)&&(r[n]=e[n]);return r};import{PublicKey as q,SystemProgram as ns}from"@solana/web3.js";import{createAssociatedTokenAccountInstruction as os}from"@solana/spl-token";import{PublicKey as Un}from"@solana/web3.js";import{get as Br,set as On}from"lodash";var Vt=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let r=t.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(r)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Rr={},Wn={};function J(e){let t=Br(Rr,e);if(!t){let r=Br(Wn,e);t=new Vt({name:e,logLevel:r}),On(Rr,e,t)}return t}import{MINT_SIZE as gs,TOKEN_PROGRAM_ID as ys,getTransferFeeConfig as hs,unpackMint as bs}from"@solana/spl-token";var Mt=J("Raydium_accountInfo_util");async function Kr(e,t,r){let{batchRequest:n,commitment:o="confirmed",chunkCount:i=100}=Y({batchRequest:!1},r),s=Ft(t,i),a=new Array(s.length).fill([]);if(n){let c=s.map(d=>{let f=e._buildArgs([d.map(p=>p.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:f}}),u=Ft(c,10);a=(await(await Promise.all(u.map(async d=>await e._rpcBatchRequest(d)))).flat()).map(d=>(d.error&&Mt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${d.error.message}`),d.result.value.map(f=>{if(f){let{data:p,executable:g,lamports:y,owner:x,rentEpoch:T}=f;return p.length!==2&&p[1]!=="base64"&&Mt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:g,lamports:y,owner:new Un(x),rentEpoch:T}}return null})))}else try{a=await Promise.all(s.map(c=>e.getMultipleAccountsInfo(c,o)))}catch(c){c instanceof Error&&Mt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}import xe from"bn.js";var Ee=9e15,Le=1e9,Et="0123456789abcdef",ct="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",lt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Nt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ee,maxE:Ee,crypto:!1},Fr,ye,R=!0,ft="[DecimalError] ",Se=ft+"Invalid argument: ",Er=ft+"Precision limit exceeded",Nr=ft+"crypto unavailable",_r="[object Decimal]",ie=Math.floor,re=Math.pow,qn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Gn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,Hn=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,vr=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,de=1e7,L=7,jn=9007199254740991,zn=ct.length-1,_t=lt.length-1,h={toStringTag:_r};h.absoluteValue=h.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),S(e)};h.ceil=function(){return S(new this.constructor(this),this.e+1,2)};h.clampedTo=h.clamp=function(e,t){var r,n=this,o=n.constructor;if(e=new o(e),t=new o(t),!e.s||!t.s)return new o(NaN);if(e.gt(t))throw Error(Se+t);return r=n.cmp(e),r<0?e:n.cmp(t)>0?t:new o(n)};h.comparedTo=h.cmp=function(e){var t,r,n,o,i=this,s=i.d,a=(e=new i.constructor(e)).d,c=i.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(i.e!==e.e)return i.e>e.e^c<0?1:-1;for(n=s.length,o=a.length,t=0,r=n<o?n:o;t<r;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return n===o?0:n>o^c<0?1:-1};h.cosine=h.cos=function(){var e,t,r=this,n=r.constructor;return r.d?r.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+L,n.rounding=1,r=Yn(n,qr(n,r)),n.precision=e,n.rounding=t,S(ye==2||ye==3?r.neg():r,e,t,!0)):new n(1):new n(NaN)};h.cubeRoot=h.cbrt=function(){var e,t,r,n,o,i,s,a,c,u,l=this,d=l.constructor;if(!l.isFinite()||l.isZero())return new d(l);for(R=!1,i=l.s*re(l.s*l,1/3),!i||Math.abs(i)==1/0?(r=oe(l.d),e=l.e,(i=(e-r.length+1)%3)&&(r+=i==1||i==-2?"0":"00"),i=re(r,1/3),e=ie((e+1)/3)-(e%3==(e<0?-1:2)),i==1/0?r="5e"+e:(r=i.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),n=new d(r),n.s=l.s):n=new d(i.toString()),s=(e=d.precision)+3;;)if(a=n,c=a.times(a).times(a),u=c.plus(l),n=H(u.plus(l).times(a),u.plus(c),s+2,1),oe(a.d).slice(0,s)===(r=oe(n.d)).slice(0,s))if(r=r.slice(s-3,s+1),r=="9999"||!o&&r=="4999"){if(!o&&(S(a,e+1,0),a.times(a).times(a).eq(l))){n=a;break}s+=4,o=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(S(n,e+1,1),t=!n.times(n).times(n).eq(l));break}return R=!0,S(n,e,d.rounding,t)};h.decimalPlaces=h.dp=function(){var e,t=this.d,r=NaN;if(t){if(e=t.length-1,r=(e-ie(this.e/L))*L,e=t[e],e)for(;e%10==0;e/=10)r--;r<0&&(r=0)}return r};h.dividedBy=h.div=function(e){return H(this,new this.constructor(e))};h.dividedToIntegerBy=h.divToInt=function(e){var t=this,r=t.constructor;return S(H(t,new r(e),0,1,1),r.precision,r.rounding)};h.equals=h.eq=function(e){return this.cmp(e)===0};h.floor=function(){return S(new this.constructor(this),this.e+1,3)};h.greaterThan=h.gt=function(e){return this.cmp(e)>0};h.greaterThanOrEqualTo=h.gte=function(e){var t=this.cmp(e);return t==1||t===0};h.hyperbolicCosine=h.cosh=function(){var e,t,r,n,o,i=this,s=i.constructor,a=new s(1);if(!i.isFinite())return new s(i.s?1/0:NaN);if(i.isZero())return a;r=s.precision,n=s.rounding,s.precision=r+Math.max(i.e,i.sd())+4,s.rounding=1,o=i.d.length,o<32?(e=Math.ceil(o/3),t=(1/mt(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),i=Ne(s,1,i.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=i.times(i),i=a.minus(c.times(l.minus(c.times(l))));return S(i,s.precision=r,s.rounding=n,!0)};h.hyperbolicSine=h.sinh=function(){var e,t,r,n,o=this,i=o.constructor;if(!o.isFinite()||o.isZero())return new i(o);if(t=i.precision,r=i.rounding,i.precision=t+Math.max(o.e,o.sd())+4,i.rounding=1,n=o.d.length,n<3)o=Ne(i,2,o,o,!0);else{e=1.4*Math.sqrt(n),e=e>16?16:e|0,o=o.times(1/mt(5,e)),o=Ne(i,2,o,o,!0);for(var s,a=new i(5),c=new i(16),u=new i(20);e--;)s=o.times(o),o=o.times(a.plus(s.times(c.times(s).plus(u))))}return i.precision=t,i.rounding=r,S(o,t,r,!0)};h.hyperbolicTangent=h.tanh=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,H(r.sinh(),r.cosh(),n.precision=e,n.rounding=t)):new n(r.s)};h.inverseCosine=h.acos=function(){var e,t=this,r=t.constructor,n=t.abs().cmp(1),o=r.precision,i=r.rounding;return n!==-1?n===0?t.isNeg()?le(r,o,i):new r(0):new r(NaN):t.isZero()?le(r,o+4,i).times(.5):(r.precision=o+6,r.rounding=1,t=t.asin(),e=le(r,o+4,i).times(.5),r.precision=o,r.rounding=i,e.minus(t))};h.inverseHyperbolicCosine=h.acosh=function(){var e,t,r=this,n=r.constructor;return r.lte(1)?new n(r.eq(1)?0:NaN):r.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(r.e),r.sd())+4,n.rounding=1,R=!1,r=r.times(r).minus(1).sqrt().plus(r),R=!0,n.precision=e,n.rounding=t,r.ln()):new n(r)};h.inverseHyperbolicSine=h.asinh=function(){var e,t,r=this,n=r.constructor;return!r.isFinite()||r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(r.e),r.sd())+6,n.rounding=1,R=!1,r=r.times(r).plus(1).sqrt().plus(r),R=!0,n.precision=e,n.rounding=t,r.ln())};h.inverseHyperbolicTangent=h.atanh=function(){var e,t,r,n,o=this,i=o.constructor;return o.isFinite()?o.e>=0?new i(o.abs().eq(1)?o.s/0:o.isZero()?o:NaN):(e=i.precision,t=i.rounding,n=o.sd(),Math.max(n,e)<2*-o.e-1?S(new i(o),e,t,!0):(i.precision=r=n-o.e,o=H(o.plus(1),new i(1).minus(o),r+e,1),i.precision=e+4,i.rounding=1,o=o.ln(),i.precision=e,i.rounding=t,o.times(.5))):new i(NaN)};h.inverseSine=h.asin=function(){var e,t,r,n,o=this,i=o.constructor;return o.isZero()?new i(o):(t=o.abs().cmp(1),r=i.precision,n=i.rounding,t!==-1?t===0?(e=le(i,r+4,n).times(.5),e.s=o.s,e):new i(NaN):(i.precision=r+6,i.rounding=1,o=o.div(new i(1).minus(o.times(o)).sqrt().plus(1)).atan(),i.precision=r,i.rounding=n,o.times(2)))};h.inverseTangent=h.atan=function(){var e,t,r,n,o,i,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&d+4<=_t)return s=le(l,d+4,f).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(d+4<=_t)return s=le(l,d+4,f).times(.5),s.s=u.s,s}for(l.precision=a=d+10,l.rounding=1,r=Math.min(28,a/L+2|0),e=r;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(R=!1,t=Math.ceil(a/L),n=1,c=u.times(u),s=new l(u),o=u;e!==-1;)if(o=o.times(c),i=s.minus(o.div(n+=2)),o=o.times(c),s=i.plus(o.div(n+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===i.d[e]&&e--;);return r&&(s=s.times(2<<r-1)),R=!0,S(s,l.precision=d,l.rounding=f,!0)};h.isFinite=function(){return!!this.d};h.isInteger=h.isInt=function(){return!!this.d&&ie(this.e/L)>this.d.length-2};h.isNaN=function(){return!this.s};h.isNegative=h.isNeg=function(){return this.s<0};h.isPositive=h.isPos=function(){return this.s>0};h.isZero=function(){return!!this.d&&this.d[0]===0};h.lessThan=h.lt=function(e){return this.cmp(e)<0};h.lessThanOrEqualTo=h.lte=function(e){return this.cmp(e)<1};h.logarithm=h.log=function(e){var t,r,n,o,i,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding,p=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),r=e.d,e.s<0||!r||!r[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(r=u.d,u.s<0||!r||!r[0]||u.eq(1))return new l(r&&!r[0]?-1/0:u.s!=1?NaN:r?0:1/0);if(t)if(r.length>1)i=!0;else{for(o=r[0];o%10===0;)o/=10;i=o!==1}if(R=!1,a=d+p,s=Ie(u,a),n=t?dt(l,a+10):Ie(e,a),c=H(s,n,a,1),We(c.d,o=d,f))do if(a+=10,s=Ie(u,a),n=t?dt(l,a+10):Ie(e,a),c=H(s,n,a,1),!i){+oe(c.d).slice(o+1,o+15)+1==1e14&&(c=S(c,d+1,0));break}while(We(c.d,o+=10,f));return R=!0,S(c,d,f)};h.minus=h.sub=function(e){var t,r,n,o,i,s,a,c,u,l,d,f,p=this,g=p.constructor;if(e=new g(e),!p.d||!e.d)return!p.s||!e.s?e=new g(NaN):p.d?e.s=-e.s:e=new g(e.d||p.s!==e.s?p:NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(u=p.d,f=e.d,a=g.precision,c=g.rounding,!u[0]||!f[0]){if(f[0])e.s=-e.s;else if(u[0])e=new g(p);else return new g(c===3?-0:0);return R?S(e,a,c):e}if(r=ie(e.e/L),l=ie(p.e/L),u=u.slice(),i=l-r,i){for(d=i<0,d?(t=u,i=-i,s=f.length):(t=f,r=l,s=u.length),n=Math.max(Math.ceil(a/L),s)+2,i>n&&(i=n,t.length=1),t.reverse(),n=i;n--;)t.push(0);t.reverse()}else{for(n=u.length,s=f.length,d=n<s,d&&(s=n),n=0;n<s;n++)if(u[n]!=f[n]){d=u[n]<f[n];break}i=0}for(d&&(t=u,u=f,f=t,e.s=-e.s),s=u.length,n=f.length-s;n>0;--n)u[s++]=0;for(n=f.length;n>i;){if(u[--n]<f[n]){for(o=n;o&&u[--o]===0;)u[o]=de-1;--u[o],u[n]+=de}u[n]-=f[n]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--r;return u[0]?(e.d=u,e.e=pt(u,r),R?S(e,a,c):e):new g(c===3?-0:0)};h.modulo=h.mod=function(e){var t,r=this,n=r.constructor;return e=new n(e),!r.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||r.d&&!r.d[0]?S(new n(r),n.precision,n.rounding):(R=!1,n.modulo==9?(t=H(r,e.abs(),0,3,1),t.s*=e.s):t=H(r,e,0,n.modulo,1),t=t.times(e),R=!0,r.minus(t))};h.naturalExponential=h.exp=function(){return vt(this)};h.naturalLogarithm=h.ln=function(){return Ie(this)};h.negated=h.neg=function(){var e=new this.constructor(this);return e.s=-e.s,S(e)};h.plus=h.add=function(e){var t,r,n,o,i,s,a,c,u,l,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return!d.s||!e.s?e=new f(NaN):d.d||(e=new f(e.d||d.s===e.s?d:NaN)),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(u=d.d,l=e.d,a=f.precision,c=f.rounding,!u[0]||!l[0])return l[0]||(e=new f(d)),R?S(e,a,c):e;if(i=ie(d.e/L),n=ie(e.e/L),u=u.slice(),o=i-n,o){for(o<0?(r=u,o=-o,s=l.length):(r=l,n=i,s=u.length),i=Math.ceil(a/L),s=i>s?i+1:s+1,o>s&&(o=s,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(s=u.length,o=l.length,s-o<0&&(o=s,r=l,l=u,u=r),t=0;o;)t=(u[--o]=u[o]+l[o]+t)/de|0,u[o]%=de;for(t&&(u.unshift(t),++n),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=pt(u,n),R?S(e,a,c):e};h.precision=h.sd=function(e){var t,r=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Se+e);return r.d?(t=Dr(r.d),e&&r.e+1>t&&(t=r.e+1)):t=NaN,t};h.round=function(){var e=this,t=e.constructor;return S(new t(e),e.e+1,t.rounding)};h.sine=h.sin=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+Math.max(r.e,r.sd())+L,n.rounding=1,r=Xn(n,qr(n,r)),n.precision=e,n.rounding=t,S(ye>2?r.neg():r,e,t,!0)):new n(NaN)};h.squareRoot=h.sqrt=function(){var e,t,r,n,o,i,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(R=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=oe(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=ie((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),n=new l(t)):n=new l(u.toString()),r=(c=l.precision)+3;;)if(i=n,n=i.plus(H(s,i,r+2,1)).times(.5),oe(i.d).slice(0,r)===(t=oe(n.d)).slice(0,r))if(t=t.slice(r-3,r+1),t=="9999"||!o&&t=="4999"){if(!o&&(S(i,c+1,0),i.times(i).eq(s))){n=i;break}r+=4,o=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(S(n,c+1,1),e=!n.times(n).eq(s));break}return R=!0,S(n,c,l.rounding,e)};h.tangent=h.tan=function(){var e,t,r=this,n=r.constructor;return r.isFinite()?r.isZero()?new n(r):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,r=r.sin(),r.s=1,r=H(r,new n(1).minus(r.times(r)).sqrt(),e+10,0),n.precision=e,n.rounding=t,S(ye==2||ye==4?r.neg():r,e,t,!0)):new n(NaN)};h.times=h.mul=function(e){var t,r,n,o,i,s,a,c,u,l=this,d=l.constructor,f=l.d,p=(e=new d(e)).d;if(e.s*=l.s,!f||!f[0]||!p||!p[0])return new d(!e.s||f&&!f[0]&&!p||p&&!p[0]&&!f?NaN:!f||!p?e.s/0:e.s*0);for(r=ie(l.e/L)+ie(e.e/L),c=f.length,u=p.length,c<u&&(i=f,f=p,p=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,o=c+n;o>n;)a=i[o]+p[n]*f[o-n-1]+t,i[o--]=a%de|0,t=a/de|0;i[o]=(i[o]+t)%de|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=pt(i,r),R?S(e,d.precision,d.rounding):e};h.toBinary=function(e,t){return Ot(this,2,e,t)};h.toDecimalPlaces=h.toDP=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ae(e,0,Le),t===void 0?t=n.rounding:ae(t,0,8),S(r,e+r.e+1,t))};h.toExponential=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=pe(n,!0):(ae(e,0,Le),t===void 0?t=o.rounding:ae(t,0,8),n=S(new o(n),e+1,t),r=pe(n,!0,e+1)),n.isNeg()&&!n.isZero()?"-"+r:r};h.toFixed=function(e,t){var r,n,o=this,i=o.constructor;return e===void 0?r=pe(o):(ae(e,0,Le),t===void 0?t=i.rounding:ae(t,0,8),n=S(new i(o),e+o.e+1,t),r=pe(n,!1,e+n.e+1)),o.isNeg()&&!o.isZero()?"-"+r:r};h.toFraction=function(e){var t,r,n,o,i,s,a,c,u,l,d,f,p=this,g=p.d,y=p.constructor;if(!g)return new y(p);if(u=r=new y(1),n=c=new y(0),t=new y(n),i=t.e=Dr(g)-p.e-1,s=i%L,t.d[0]=re(10,s<0?L+s:s),e==null)e=i>0?t:u;else{if(a=new y(e),!a.isInt()||a.lt(u))throw Error(Se+a);e=a.gt(t)?i>0?t:u:a}for(R=!1,a=new y(oe(g)),l=y.precision,y.precision=i=g.length*L*2;d=H(a,t,0,1,1),o=r.plus(d.times(n)),o.cmp(e)!=1;)r=n,n=o,o=u,u=c.plus(d.times(o)),c=o,o=t,t=a.minus(d.times(o)),a=o;return o=H(e.minus(r),n,0,1,1),c=c.plus(o.times(u)),r=r.plus(o.times(n)),c.s=u.s=p.s,f=H(u,n,i,1).minus(p).abs().cmp(H(c,r,i,1).minus(p).abs())<1?[u,n]:[c,r],y.precision=l,R=!0,f};h.toHexadecimal=h.toHex=function(e,t){return Ot(this,16,e,t)};h.toNearest=function(e,t){var r=this,n=r.constructor;if(r=new n(r),e==null){if(!r.d)return r;e=new n(1),t=n.rounding}else{if(e=new n(e),t===void 0?t=n.rounding:ae(t,0,8),!r.d)return e.s?r:e;if(!e.d)return e.s&&(e.s=r.s),e}return e.d[0]?(R=!1,r=H(r,e,0,t,1).times(e),R=!0,S(r)):(e.s=r.s,r=e),r};h.toNumber=function(){return+this};h.toOctal=function(e,t){return Ot(this,8,e,t)};h.toPower=h.pow=function(e){var t,r,n,o,i,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(re(+a,u));if(a=new c(a),a.eq(1))return a;if(n=c.precision,i=c.rounding,e.eq(1))return S(a,n,i);if(t=ie(e.e/L),t>=e.d.length-1&&(r=u<0?-u:u)<=jn)return o=Or(c,a,r,n),e.s<0?new c(1).div(o):S(o,n,i);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return r=re(+a,u),t=r==0||!isFinite(r)?ie(u*(Math.log("0."+oe(a.d))/Math.LN10+a.e+1)):new c(r+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(R=!1,c.rounding=a.s=1,r=Math.min(12,(t+"").length),o=vt(e.times(Ie(a,n+r)),n),o.d&&(o=S(o,n+5,1),We(o.d,n,i)&&(t=n+10,o=S(vt(e.times(Ie(a,t+r)),t),t+5,1),+oe(o.d).slice(n+1,n+15)+1==1e14&&(o=S(o,n+1,0)))),o.s=s,R=!0,c.rounding=i,S(o,n,i))};h.toPrecision=function(e,t){var r,n=this,o=n.constructor;return e===void 0?r=pe(n,n.e<=o.toExpNeg||n.e>=o.toExpPos):(ae(e,1,Le),t===void 0?t=o.rounding:ae(t,0,8),n=S(new o(n),e,t),r=pe(n,e<=n.e||n.e<=o.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+r:r};h.toSignificantDigits=h.toSD=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ae(e,1,Le),t===void 0?t=n.rounding:ae(t,0,8)),S(new n(r),e,t)};h.toString=function(){var e=this,t=e.constructor,r=pe(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+r:r};h.truncated=h.trunc=function(){return S(new this.constructor(this),this.e+1,1)};h.valueOf=h.toJSON=function(){var e=this,t=e.constructor,r=pe(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+r:r};function oe(e){var t,r,n,o=e.length-1,i="",s=e[0];if(o>0){for(i+=s,t=1;t<o;t++)n=e[t]+"",r=L-n.length,r&&(i+=Ae(r)),i+=n;s=e[t],n=s+"",r=L-n.length,r&&(i+=Ae(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}function ae(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Se+e)}function We(e,t,r,n){var o,i,s,a;for(i=e[0];i>=10;i/=10)--t;return--t<0?(t+=L,o=0):(o=Math.ceil((t+1)/L),t%=L),i=re(10,L-t),a=e[o]%i|0,n==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=r<4&&a==99999||r>3&&a==49999||a==5e4||a==0):s=(r<4&&a+1==i||r>3&&a+1==i/2)&&(e[o+1]/i/100|0)==re(10,t-2)-1||(a==i/2||a==0)&&(e[o+1]/i/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(n||r<4)&&a==9999||!n&&r>3&&a==4999):s=((n||r<4)&&a+1==i||!n&&r>3&&a+1==i/2)&&(e[o+1]/i/1e3|0)==re(10,t-3)-1,s}function ut(e,t,r){for(var n,o=[0],i,s=0,a=e.length;s<a;){for(i=o.length;i--;)o[i]*=t;for(o[0]+=Et.indexOf(e.charAt(s++)),n=0;n<o.length;n++)o[n]>r-1&&(o[n+1]===void 0&&(o[n+1]=0),o[n+1]+=o[n]/r|0,o[n]%=r)}return o.reverse()}function Yn(e,t){var r,n,o;if(t.isZero())return t;n=t.d.length,n<32?(r=Math.ceil(n/3),o=(1/mt(4,r)).toString()):(r=16,o="2.3283064365386962890625e-10"),e.precision+=r,t=Ne(e,1,t.times(o),new e(1));for(var i=r;i--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=r,t}var H=function(){function e(n,o,i){var s,a=0,c=n.length;for(n=n.slice();c--;)s=n[c]*o+a,n[c]=s%i|0,a=s/i|0;return a&&n.unshift(a),n}function t(n,o,i,s){var a,c;if(i!=s)c=i>s?1:-1;else for(a=c=0;a<i;a++)if(n[a]!=o[a]){c=n[a]>o[a]?1:-1;break}return c}function r(n,o,i,s){for(var a=0;i--;)n[i]-=a,a=n[i]<o[i]?1:0,n[i]=a*s+n[i]-o[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,o,i,s,a,c){var u,l,d,f,p,g,y,x,T,k,b,w,A,I,F,G,B,K,v,O,E=n.constructor,ee=n.s==o.s?1:-1,z=n.d,W=o.d;if(!z||!z[0]||!W||!W[0])return new E(!n.s||!o.s||(z?W&&z[0]==W[0]:!W)?NaN:z&&z[0]==0||!W?ee*0:ee/0);for(c?(p=1,l=n.e-o.e):(c=de,p=L,l=ie(n.e/p)-ie(o.e/p)),v=W.length,B=z.length,T=new E(ee),k=T.d=[],d=0;W[d]==(z[d]||0);d++);if(W[d]>(z[d]||0)&&l--,i==null?(I=i=E.precision,s=E.rounding):a?I=i+(n.e-o.e)+1:I=i,I<0)k.push(1),g=!0;else{if(I=I/p+2|0,d=0,v==1){for(f=0,W=W[0],I++;(d<B||f)&&I--;d++)F=f*c+(z[d]||0),k[d]=F/W|0,f=F%W|0;g=f||d<B}else{for(f=c/(W[0]+1)|0,f>1&&(W=e(W,f,c),z=e(z,f,c),v=W.length,B=z.length),G=v,b=z.slice(0,v),w=b.length;w<v;)b[w++]=0;O=W.slice(),O.unshift(0),K=W[0],W[1]>=c/2&&++K;do f=0,u=t(W,b,v,w),u<0?(A=b[0],v!=w&&(A=A*c+(b[1]||0)),f=A/K|0,f>1?(f>=c&&(f=c-1),y=e(W,f,c),x=y.length,w=b.length,u=t(y,b,x,w),u==1&&(f--,r(y,v<x?O:W,x,c))):(f==0&&(u=f=1),y=W.slice()),x=y.length,x<w&&y.unshift(0),r(b,y,w,c),u==-1&&(w=b.length,u=t(W,b,v,w),u<1&&(f++,r(b,v<w?O:W,w,c))),w=b.length):u===0&&(f++,b=[0]),k[d++]=f,u&&b[0]?b[w++]=z[G]||0:(b=[z[G]],w=1);while((G++<B||b[0]!==void 0)&&I--);g=b[0]!==void 0}k[0]||k.shift()}if(p==1)T.e=l,Fr=g;else{for(d=1,f=k[0];f>=10;f/=10)d++;T.e=d+l*p-1,S(T,a?i+T.e+1:i,s,g)}return T}}();function S(e,t,r,n){var o,i,s,a,c,u,l,d,f,p=e.constructor;e:if(t!=null){if(d=e.d,!d)return e;for(o=1,a=d[0];a>=10;a/=10)o++;if(i=t-o,i<0)i+=L,s=t,l=d[f=0],c=l/re(10,o-s-1)%10|0;else if(f=Math.ceil((i+1)/L),a=d.length,f>=a)if(n){for(;a++<=f;)d.push(0);l=c=0,o=1,i%=L,s=i-L+1}else break e;else{for(l=a=d[f],o=1;a>=10;a/=10)o++;i%=L,s=i-L+o,c=s<0?0:l/re(10,o-s-1)%10|0}if(n=n||t<0||d[f+1]!==void 0||(s<0?l:l%re(10,o-s-1)),u=r<4?(c||n)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||n||r==6&&(i>0?s>0?l/re(10,o-s):0:d[f-1])%10&1||r==(e.s<0?8:7)),t<1||!d[0])return d.length=0,u?(t-=e.e+1,d[0]=re(10,(L-t%L)%L),e.e=-t||0):d[0]=e.e=0,e;if(i==0?(d.length=f,a=1,f--):(d.length=f+1,a=re(10,L-i),d[f]=s>0?(l/re(10,o-s)%re(10,s)|0)*a:0),u)for(;;)if(f==0){for(i=1,s=d[0];s>=10;s/=10)i++;for(s=d[0]+=a,a=1;s>=10;s/=10)a++;i!=a&&(e.e++,d[0]==de&&(d[0]=1));break}else{if(d[f]+=a,d[f]!=de)break;d[f--]=0,a=1}for(i=d.length;d[--i]===0;)d.pop()}return R&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function pe(e,t,r){if(!e.isFinite())return Ur(e);var n,o=e.e,i=oe(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Ae(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(e.e<0?"e":"e+")+e.e):o<0?(i="0."+Ae(-o-1)+i,r&&(n=r-s)>0&&(i+=Ae(n))):o>=s?(i+=Ae(o+1-s),r&&(n=r-o-1)>0&&(i=i+"."+Ae(n))):((n=o+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(o+1===s&&(i+="."),i+=Ae(n))),i}function pt(e,t){var r=e[0];for(t*=L;r>=10;r/=10)t++;return t}function dt(e,t,r){if(t>zn)throw R=!0,r&&(e.precision=r),Error(Er);return S(new e(ct),t,1,!0)}function le(e,t,r){if(t>_t)throw Error(Er);return S(new e(lt),t,r,!0)}function Dr(e){var t=e.length-1,r=t*L+1;if(t=e[t],t){for(;t%10==0;t/=10)r--;for(t=e[0];t>=10;t/=10)r++}return r}function Ae(e){for(var t="";e--;)t+="0";return t}function Or(e,t,r,n){var o,i=new e(1),s=Math.ceil(n/L+4);for(R=!1;;){if(r%2&&(i=i.times(t),Vr(i.d,s)&&(o=!0)),r=ie(r/2),r===0){r=i.d.length-1,o&&i.d[r]===0&&++i.d[r];break}t=t.times(t),Vr(t.d,s)}return R=!0,i}function Cr(e){return e.d[e.d.length-1]&1}function Wr(e,t,r){for(var n,o=new e(t[0]),i=0;++i<t.length;)if(n=new e(t[i]),n.s)o[r](n)&&(o=n);else{o=n;break}return o}function vt(e,t){var r,n,o,i,s,a,c,u=0,l=0,d=0,f=e.constructor,p=f.rounding,g=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(R=!1,c=g):c=t,a=new f(.03125);e.e>-2;)e=e.times(a),d+=5;for(n=Math.log(re(2,d))/Math.LN10*2+5|0,c+=n,r=i=s=new f(1),f.precision=c;;){if(i=S(i.times(e),c,1),r=r.times(++l),a=s.plus(H(i,r,c,1)),oe(a.d).slice(0,c)===oe(s.d).slice(0,c)){for(o=d;o--;)s=S(s.times(s),c,1);if(t==null)if(u<3&&We(s.d,c-n,p,u))f.precision=c+=10,r=i=a=new f(1),l=0,u++;else return S(s,f.precision=g,p,R=!0);else return f.precision=g,s}s=a}}function Ie(e,t){var r,n,o,i,s,a,c,u,l,d,f,p=1,g=10,y=e,x=y.d,T=y.constructor,k=T.rounding,b=T.precision;if(y.s<0||!x||!x[0]||!y.e&&x[0]==1&&x.length==1)return new T(x&&!x[0]?-1/0:y.s!=1?NaN:x?0:y);if(t==null?(R=!1,l=b):l=t,T.precision=l+=g,r=oe(x),n=r.charAt(0),Math.abs(i=y.e)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)y=y.times(e),r=oe(y.d),n=r.charAt(0),p++;i=y.e,n>1?(y=new T("0."+r),i++):y=new T(n+"."+r.slice(1))}else return u=dt(T,l+2,b).times(i+""),y=Ie(new T(n+"."+r.slice(1)),l-g).plus(u),T.precision=b,t==null?S(y,b,k,R=!0):y;for(d=y,c=s=y=H(y.minus(1),y.plus(1),l,1),f=S(y.times(y),l,1),o=3;;){if(s=S(s.times(f),l,1),u=c.plus(H(s,new T(o),l,1)),oe(u.d).slice(0,l)===oe(c.d).slice(0,l))if(c=c.times(2),i!==0&&(c=c.plus(dt(T,l+2,b).times(i+""))),c=H(c,new T(p),l,1),t==null)if(We(c.d,l-g,k,a))T.precision=l+=g,u=s=y=H(d.minus(1),d.plus(1),l,1),f=S(y.times(y),l,1),o=a=1;else return S(c,T.precision=b,k,R=!0);else return T.precision=b,c;c=u,o+=2}}function Ur(e){return String(e.s*e.s/0)}function Dt(e,t){var r,n,o;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;n++);for(o=t.length;t.charCodeAt(o-1)===48;--o);if(t=t.slice(n,o),t){if(o-=n,e.e=r=r-n-1,e.d=[],n=(r+1)%L,r<0&&(n+=L),n<o){for(n&&e.d.push(+t.slice(0,n)),o-=L;n<o;)e.d.push(+t.slice(n,n+=L));t=t.slice(n),n=L-t.length}else n-=o;for(;n--;)t+="0";e.d.push(+t),R&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Zn(e,t){var r,n,o,i,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),vr.test(t))return Dt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Gn.test(t))r=16,t=t.toLowerCase();else if(qn.test(t))r=2;else if(Hn.test(t))r=8;else throw Error(Se+t);for(i=t.search(/p/i),i>0?(c=+t.slice(i+1),t=t.substring(2,i)):t=t.slice(2),i=t.indexOf("."),s=i>=0,n=e.constructor,s&&(t=t.replace(".",""),a=t.length,i=a-i,o=Or(n,new n(r),i,i*2)),u=ut(t,r,de),l=u.length-1,i=l;u[i]===0;--i)u.pop();return i<0?new n(e.s*0):(e.e=pt(u,l),e.d=u,R=!1,s&&(e=H(e,o,a*4)),c&&(e=e.times(Math.abs(c)<54?re(2,c):Ue.pow(2,c))),R=!0,e)}function Xn(e,t){var r,n=t.d.length;if(n<3)return t.isZero()?t:Ne(e,2,t,t);r=1.4*Math.sqrt(n),r=r>16?16:r|0,t=t.times(1/mt(5,r)),t=Ne(e,2,t,t);for(var o,i=new e(5),s=new e(16),a=new e(20);r--;)o=t.times(t),t=t.times(i.plus(o.times(s.times(o).minus(a))));return t}function Ne(e,t,r,n,o){var i,s,a,c,u=1,l=e.precision,d=Math.ceil(l/L);for(R=!1,c=r.times(r),a=new e(n);;){if(s=H(a.times(c),new e(t++*t++),l,1),a=o?n.plus(s):n.minus(s),n=H(s.times(c),new e(t++*t++),l,1),s=a.plus(n),s.d[d]!==void 0){for(i=d;s.d[i]===a.d[i]&&i--;);if(i==-1)break}i=a,a=n,n=s,s=i,u++}return R=!0,s.d.length=d+1,s}function mt(e,t){for(var r=e;--t;)r*=e;return r}function qr(e,t){var r,n=t.s<0,o=le(e,e.precision,1),i=o.times(.5);if(t=t.abs(),t.lte(i))return ye=n?4:1,t;if(r=t.divToInt(o),r.isZero())ye=n?3:2;else{if(t=t.minus(r.times(o)),t.lte(i))return ye=Cr(r)?n?2:3:n?4:1,t;ye=Cr(r)?n?1:4:n?3:2}return t.minus(o).abs()}function Ot(e,t,r,n){var o,i,s,a,c,u,l,d,f,p=e.constructor,g=r!==void 0;if(g?(ae(r,1,Le),n===void 0?n=p.rounding:ae(n,0,8)):(r=p.precision,n=p.rounding),!e.isFinite())l=Ur(e);else{for(l=pe(e),s=l.indexOf("."),g?(o=2,t==16?r=r*4-3:t==8&&(r=r*3-2)):o=t,s>=0&&(l=l.replace(".",""),f=new p(1),f.e=l.length-s,f.d=ut(pe(f),10,o),f.e=f.d.length),d=ut(l,10,o),i=c=d.length;d[--c]==0;)d.pop();if(!d[0])l=g?"0p+0":"0";else{if(s<0?i--:(e=new p(e),e.d=d,e.e=i,e=H(e,f,r,n,0,o),d=e.d,i=e.e,u=Fr),s=d[r],a=o/2,u=u||d[r+1]!==void 0,u=n<4?(s!==void 0||u)&&(n===0||n===(e.s<0?3:2)):s>a||s===a&&(n===4||u||n===6&&d[r-1]&1||n===(e.s<0?8:7)),d.length=r,u)for(;++d[--r]>o-1;)d[r]=0,r||(++i,d.unshift(1));for(c=d.length;!d[c-1];--c);for(s=0,l="";s<c;s++)l+=Et.charAt(d[s]);if(g){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(d=ut(l,o,t),c=d.length;!d[c-1];--c);for(s=1,l="1.";s<c;s++)l+=Et.charAt(d[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)l="0"+l;l="0."+l}else if(++i>c)for(i-=c;i--;)l+="0";else i<c&&(l=l.slice(0,i)+"."+l.slice(i))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function Vr(e,t){if(e.length>t)return e.length=t,!0}function Qn(e){return new this(e).abs()}function Jn(e){return new this(e).acos()}function $n(e){return new this(e).acosh()}function eo(e,t){return new this(e).plus(t)}function to(e){return new this(e).asin()}function ro(e){return new this(e).asinh()}function no(e){return new this(e).atan()}function oo(e){return new this(e).atanh()}function io(e,t){e=new this(e),t=new this(t);var r,n=this.precision,o=this.rounding,i=n+4;return!e.s||!t.s?r=new this(NaN):!e.d&&!t.d?(r=le(this,i,1).times(t.s>0?.25:.75),r.s=e.s):!t.d||e.isZero()?(r=t.s<0?le(this,n,o):new this(0),r.s=e.s):!e.d||t.isZero()?(r=le(this,i,1).times(.5),r.s=e.s):t.s<0?(this.precision=i,this.rounding=1,r=this.atan(H(e,t,i,1)),t=le(this,i,1),this.precision=n,this.rounding=o,r=e.s<0?r.minus(t):r.plus(t)):r=this.atan(H(e,t,i,1)),r}function so(e){return new this(e).cbrt()}function ao(e){return S(e=new this(e),e.e+1,2)}function uo(e,t,r){return new this(e).clamp(t,r)}function co(e){if(!e||typeof e!="object")throw Error(ft+"Object expected");var t,r,n,o=e.defaults===!0,i=["precision",1,Le,"rounding",0,8,"toExpNeg",-Ee,0,"toExpPos",0,Ee,"maxE",0,Ee,"minE",-Ee,0,"modulo",0,9];for(t=0;t<i.length;t+=3)if(r=i[t],o&&(this[r]=Nt[r]),(n=e[r])!==void 0)if(ie(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(Se+r+": "+n);if(r="crypto",o&&(this[r]=Nt[r]),(n=e[r])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(Nr);else this[r]=!1;else throw Error(Se+r+": "+n);return this}function lo(e){return new this(e).cos()}function fo(e){return new this(e).cosh()}function Gr(e){var t,r,n;function o(i){var s,a,c,u=this;if(!(u instanceof o))return new o(i);if(u.constructor=o,Mr(i)){u.s=i.s,R?!i.d||i.e>o.maxE?(u.e=NaN,u.d=null):i.e<o.minE?(u.e=0,u.d=[0]):(u.e=i.e,u.d=i.d.slice()):(u.e=i.e,u.d=i.d?i.d.slice():i.d);return}if(c=typeof i,c==="number"){if(i===0){u.s=1/i<0?-1:1,u.e=0,u.d=[0];return}if(i<0?(i=-i,u.s=-1):u.s=1,i===~~i&&i<1e7){for(s=0,a=i;a>=10;a/=10)s++;R?s>o.maxE?(u.e=NaN,u.d=null):s<o.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[i]):(u.e=s,u.d=[i]);return}else if(i*0!==0){i||(u.s=NaN),u.e=NaN,u.d=null;return}return Dt(u,i.toString())}else if(c!=="string")throw Error(Se+i);return(a=i.charCodeAt(0))===45?(i=i.slice(1),u.s=-1):(a===43&&(i=i.slice(1)),u.s=1),vr.test(i)?Dt(u,i):Zn(u,i)}if(o.prototype=h,o.ROUND_UP=0,o.ROUND_DOWN=1,o.ROUND_CEIL=2,o.ROUND_FLOOR=3,o.ROUND_HALF_UP=4,o.ROUND_HALF_DOWN=5,o.ROUND_HALF_EVEN=6,o.ROUND_HALF_CEIL=7,o.ROUND_HALF_FLOOR=8,o.EUCLID=9,o.config=o.set=co,o.clone=Gr,o.isDecimal=Mr,o.abs=Qn,o.acos=Jn,o.acosh=$n,o.add=eo,o.asin=to,o.asinh=ro,o.atan=no,o.atanh=oo,o.atan2=io,o.cbrt=so,o.ceil=ao,o.clamp=uo,o.cos=lo,o.cosh=fo,o.div=po,o.exp=mo,o.floor=go,o.hypot=yo,o.ln=ho,o.log=bo,o.log10=xo,o.log2=wo,o.max=Po,o.min=To,o.mod=ko,o.mul=Ao,o.pow=Io,o.random=So,o.round=Lo,o.sign=Bo,o.sin=Ro,o.sinh=Ko,o.sqrt=Co,o.sub=Vo,o.sum=Mo,o.tan=Fo,o.tanh=Eo,o.trunc=No,e===void 0&&(e={}),e&&e.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return o.config(e),o}function po(e,t){return new this(e).div(t)}function mo(e){return new this(e).exp()}function go(e){return S(e=new this(e),e.e+1,3)}function yo(){var e,t,r=new this(0);for(R=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)r.d&&(r=r.plus(t.times(t)));else{if(t.s)return R=!0,new this(1/0);r=t}return R=!0,r.sqrt()}function Mr(e){return e instanceof Ue||e&&e.toStringTag===_r||!1}function ho(e){return new this(e).ln()}function bo(e,t){return new this(e).log(t)}function wo(e){return new this(e).log(2)}function xo(e){return new this(e).log(10)}function Po(){return Wr(this,arguments,"lt")}function To(){return Wr(this,arguments,"gt")}function ko(e,t){return new this(e).mod(t)}function Ao(e,t){return new this(e).mul(t)}function Io(e,t){return new this(e).pow(t)}function So(e){var t,r,n,o,i=0,s=new this(1),a=[];if(e===void 0?e=this.precision:ae(e,1,Le),n=Math.ceil(e/L),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));i<n;)o=t[i],o>=429e7?t[i]=crypto.getRandomValues(new Uint32Array(1))[0]:a[i++]=o%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(n*=4);i<n;)o=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+((t[i+3]&127)<<24),o>=214e7?crypto.randomBytes(4).copy(t,i):(a.push(o%1e7),i+=4);i=n/4}else throw Error(Nr);else for(;i<n;)a[i++]=Math.random()*1e7|0;for(n=a[--i],e%=L,n&&e&&(o=re(10,L-e),a[i]=(n/o|0)*o);a[i]===0;i--)a.pop();if(i<0)r=0,a=[0];else{for(r=-1;a[0]===0;r-=L)a.shift();for(n=1,o=a[0];o>=10;o/=10)n++;n<L&&(r-=L-n)}return s.e=r,s.d=a,s}function Lo(e){return S(e=new this(e),e.e+1,this.rounding)}function Bo(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Ro(e){return new this(e).sin()}function Ko(e){return new this(e).sinh()}function Co(e){return new this(e).sqrt()}function Vo(e,t){return new this(e).sub(t)}function Mo(){var e=0,t=arguments,r=new this(t[e]);for(R=!1;r.s&&++e<t.length;)r=r.plus(t[e]);return R=!0,S(r,this.precision,this.rounding)}function Fo(e){return new this(e).tan()}function Eo(e){return new this(e).tanh()}function No(e){return S(e=new this(e),e.e+1,1)}h[Symbol.for("nodejs.util.inspect.custom")]=h.toString;h[Symbol.toStringTag]="Decimal";var Ue=h.constructor=Gr(Nt);ct=new Ue(ct);lt=new Ue(lt);var Wt=Ue;import Go from"big.js";import ht from"bn.js";import _o from"toformat";var vo=_o,qe=vo;import yt from"big.js";import Oo from"bn.js";import Wo from"decimal.js-light";import Ge from"bn.js";var Hr=9007199254740991;function N(e){let t=J("Raydium_parseBigNumberish");if(e instanceof Ge)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new Ge(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Hr||e<=-Hr)&&t.logWithError(`BigNumberish number overflow: ${e}`),new Ge(String(e))):typeof e=="bigint"?new Ge(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new Ge(0))}var gt=J("module/fraction"),Ut=qe(yt),He=qe(Wo),Uo={[0]:He.ROUND_DOWN,[1]:He.ROUND_HALF_UP,[2]:He.ROUND_UP},qo={[0]:yt.roundDown,[1]:yt.roundHalfUp,[2]:yt.roundUp},U=class{constructor(t,r=new Oo(1)){this.numerator=N(t),this.denominator=N(r)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new U(this.denominator,this.numerator)}add(t){let r=t instanceof U?t:new U(N(t));return this.denominator.eq(r.denominator)?new U(this.numerator.add(r.numerator),this.denominator):new U(this.numerator.mul(r.denominator).add(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}sub(t){let r=t instanceof U?t:new U(N(t));return this.denominator.eq(r.denominator)?new U(this.numerator.sub(r.numerator),this.denominator):new U(this.numerator.mul(r.denominator).sub(r.numerator.mul(this.denominator)),this.denominator.mul(r.denominator))}mul(t){let r=t instanceof U?t:new U(N(t));return new U(this.numerator.mul(r.numerator),this.denominator.mul(r.denominator))}div(t){let r=t instanceof U?t:new U(N(t));return new U(this.numerator.mul(r.denominator),this.denominator.mul(r.numerator))}toSignificant(t,r={groupSeparator:""},n=1){Number.isInteger(t)||gt.logWithError(`${t} is not an integer.`),t<=0&&gt.logWithError(`${t} is not positive.`),He.set({precision:t+1,rounding:Uo[n]});let o=new He(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return o.toFormat(o.decimalPlaces(),r)}toFixed(t,r={groupSeparator:""},n=1){return Number.isInteger(t)||gt.logWithError(`${t} is not an integer.`),t<0&&gt.logWithError(`${t} is negative.`),Ut.DP=t,Ut.RM=qo[n]||1,new Ut(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,r)}isZero(){return this.numerator.isZero()}};var Ho=J("Raydium_amount"),jr=qe(Go);function jo(e,t){let r="0",n="0";if(e.includes(".")){let o=e.split(".");o.length===2?([r,n]=o,n=n.padEnd(t,"0")):Ho.logWithError(`invalid number string, num: ${e}`)}else r=e;return[r,n.slice(0,t)||n]}var he=class extends U{constructor(r,n,o=!0,i){let s=new ht(0),a=qt.pow(new ht(r.decimals));if(o)s=N(n);else{let c=new ht(0),u=new ht(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[l,d]=jo(n.toString(),r.decimals);c=N(l),u=N(d)}c=c.mul(a),s=c.add(u)}super(s,a);this.logger=J(i||"TokenAmount"),this.token=r}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(r){return this.token.equals(r.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(r.raw)}lt(r){return this.token.equals(r.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(r.raw)}add(r){return this.token.equals(r.token)||this.logger.logWithError("add token not equals"),new he(this.token,this.raw.add(r.raw))}subtract(r){return this.token.equals(r.token)||this.logger.logWithError("sub token not equals"),new he(this.token,this.raw.sub(r.raw))}toSignificant(r=this.token.decimals,n,o=0){return super.toSignificant(r,n,o)}toFixed(r=this.token.decimals,n,o=0){return r>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(r,n,o)}toExact(r={groupSeparator:""}){return jr.DP=this.token.decimals,new jr(this.numerator.toString()).div(this.denominator.toString()).toFormat(r)}};import{PublicKey as zo}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as zr}from"@solana/spl-token";var Yr={chainId:101,address:zo.default.toBase58(),programId:zr.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},se={chainId:101,address:"So11111111111111111111111111111111111111112",programId:zr.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as jt}from"@solana/web3.js";import{PublicKey as X,SystemProgram as Zr,SYSVAR_RENT_PUBKEY as Yo}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Zo}from"@solana/spl-token";function m({pubkey:e,isSigner:t=!1,isWritable:r=!0}){return{pubkey:e,isWritable:r,isSigner:t}}var Gt=[m({pubkey:Zo,isWritable:!1}),m({pubkey:Zr.programId,isWritable:!1}),m({pubkey:Yo,isWritable:!1})];function Xr({publicKey:e,transformSol:t}){let r=Ht(e.toString());if(r instanceof X)return t&&r.equals(ne)?ge:r;if(t&&r.toString()===ne.toBase58())return ge;if(typeof r=="string"){if(r===X.default.toBase58())return X.default;try{return new X(r)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Ht(e){try{return new X(e)}catch{return e}}var Js=new X("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),$s=new X("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Xo=new X("SysvarRent111111111111111111111111111111111"),ea=new X("SysvarC1ock11111111111111111111111111111111"),ta=new X("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Qo=new X("Sysvar1nstructions1111111111111111111111111"),ra=Zr.programId,na=new X("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),oa=new X("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),ia=new X("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),sa=new X("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),aa=new X("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),ua=new X("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),ca=new X("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),la=new X("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),da=new X("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),fa=new X("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),pa=new X("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ge=new X("So11111111111111111111111111111111111111112"),ne=X.default;var zt=class{constructor({mint:t,decimals:r,symbol:n,name:o,skipMint:i=!1,isToken2022:s=!1}){if(t===ne.toBase58()||t instanceof jt&&ne.equals(t)){this.decimals=se.decimals,this.symbol=se.symbol,this.name=se.name,this.mint=new jt(se.address),this.isToken2022=!1;return}this.decimals=r,this.symbol=n||t.toString().substring(0,6),this.name=o||t.toString().substring(0,6),this.mint=i?jt.default:Xr({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},Ce=zt;Ce.WSOL=new zt(te(Y({},se),{mint:se.address}));var Yt=class{constructor({decimals:t,symbol:r="UNKNOWN",name:n="UNKNOWN"}){this.decimals=t,this.symbol=r,this.name=n}equals(t){return this===t}},bt=Yt;bt.SOL=new Yt(Yr);import Jo from"bn.js";var Qr=new U(new Jo(100)),_e=class extends U{toSignificant(t=5,r,n){return this.mul(Qr).toSignificant(t,r,n)}toFixed(t=2,r,n){return this.mul(Qr).toFixed(t,r,n)}};var $o=J("Raydium_price"),be=class extends U{constructor(r){let{baseToken:n,quoteToken:o,numerator:i,denominator:s}=r;super(i,s);this.baseToken=n,this.quoteToken=o,this.scalar=new U(Zt(n.decimals),Zt(o.decimals))}get raw(){return new U(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new be({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(r){this.quoteToken!==r.baseToken&&$o.logWithError("mul token not equals");let n=super.mul(r);return new be({baseToken:this.baseToken,quoteToken:r.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(r=this.quoteToken.decimals,n,o){return this.adjusted.toSignificant(r,n,o)}toFixed(r=this.quoteToken.decimals,n,o){return this.adjusted.toFixed(r,n,o)}};import{PublicKey as ei}from"@solana/web3.js";import ti from"bn.js";function Jr(e){return typeof e=="object"&&e!==null&&![Ce,he,ei,U,ti,be,_e].some(t=>typeof t=="object"&&e instanceof t)}function we(e){return typeof e=="string"?Ht(e):Array.isArray(e)?e.map(t=>we(t)):Jr(e)?Object.fromEntries(Object.entries(e).map(([t,r])=>[t,we(r)])):e}var Xt=new xe(0),uu=new xe(1),cu=new xe(2),lu=new xe(3),du=new xe(5),qt=new xe(10),fu=new xe(100),pu=new xe(1e3),mu=new xe(1e4);function Zt(e){return qt.pow(N(e))}function Ft(e,t=1,r=[]){let n=[...e];if(t<=0)return r;for(;n.length;)r.push(n.splice(0,t));return r}import{PublicKey as ui}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as ci}from"@solana/spl-token";import{ComputeBudgetProgram as $r,Keypair as tn,PublicKey as ri,Transaction as rn,TransactionMessage as ni,VersionedTransaction as nn}from"@solana/web3.js";var j={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee"};import{TOKEN_PROGRAM_ID as oi}from"@solana/spl-token";var en=J("Raydium_txUtil"),on=1644;function wt(e){let t=[],r=[];return e.microLamports&&(t.push($r.setComputeUnitPrice({microLamports:e.microLamports})),r.push(j.SetComputeUnitPrice)),e.units&&(t.push($r.setComputeUnitLimit({units:e.units})),r.push(j.SetComputeUnitLimit)),{instructions:t,instructionTypes:r}}async function ve(e,t){var n,o;let r=t!=null?t:"confirmed";return(o=await((n=e.getLatestBlockhash)==null?void 0:n.call(e,{commitment:r})))==null?void 0:o.blockhash}async function xt(e,t){return e.getSignatureStatuses([t]),new Promise((r,n)=>{let o=setTimeout(n,6e4);e.onSignature(t,i=>{if(clearTimeout(o),!i.err){r("");return}n(i.err.toString())},"confirmed")})}function ii(e,t){e.length<1&&en.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&en.logWithError(`no signers provided:, ${t.toString()}`);let r=new rn;r.recentBlockhash="11111111111111111111111111111111",r.feePayer=t[0],r.add(...e);try{return Buffer.from(r.serialize({verifySignatures:!1})).toString("base64").length<on}catch{return!1}}function Ve(e,t){let[r,n]=ri.findProgramAddressSync(e,t);return{publicKey:r,nonce:n}}function je({instructions:e,payer:t,signers:r}){return ii(e,[t,...r])}function ze({instructions:e,payer:t,lookupTableAddressAccount:r,recentBlockhash:n=tn.generate().publicKey.toString()}){let i=new ni({payerKey:t,recentBlockhash:n,instructions:e}).compileToV0Message(Object.values(r!=null?r:{}));try{return Buffer.from(new nn(i).serialize()).toString("base64").length<on}catch{return!1}}var si=e=>Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e),ai=e=>{let t=e.serialize({requireAllSignatures:!1,verifySignatures:!1});e instanceof nn&&(t=si(t));try{return t instanceof Buffer?t.toString("base64"):Buffer.from(t).toString("base64")}catch{return t.toString("base64")}};function Me(e){let t=[];return e.forEach(r=>{r instanceof rn&&(r.recentBlockhash||(r.recentBlockhash=oi.toBase58()),r.feePayer||(r.feePayer=tn.generate().publicKey)),t.push(ai(r))}),console.log("simulate tx string:",t),t}function De(e,t,r){return Ve([e.toBuffer(),(r!=null?r:ci).toBuffer(),t.toBuffer()],new ui("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}import{PublicKey as M}from"@solana/web3.js";var sn=new M("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),an=new M("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),un=new M("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Ye=new M("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Eu=new M("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Nu=new M("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),_u=new M("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),vu=new M("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Du=new M("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Ou=new M("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Wu=new M("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Uu=new M("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),qu=new M("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Gu=new M("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Hu=new M("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),ju=new M("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),zu=new M("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Yu=new M("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Zu=new M("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Xu=new M("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Qu=new M("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Ju=new M("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),li=new M("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),di=new M("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),fi=new M("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),$u=new M("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),pi=new M("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),ec=new M("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),mi=new M("7AFUeLVRjBfzqK3tTGw8hN48KLQWSk6DTE8xprWdPqix");var tc={SERUM_MARKET:M.default,OPENBOOK_MARKET:new M("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),UTIL1216:M.default,FarmV3:new M("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FarmV5:new M("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FarmV6:new M("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),AmmV4:new M("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AmmStable:new M("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM:new M("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),CLMM_LOCK_PROGRAM_ID:new M("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),CLMM_LOCK_AUTH_ID:new M("8qmHNvu2Kr2C7U8mJL4Vz1vTDxMhVuXKREwU7TNoaVEo"),Router:new M("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:li,CREATE_CPMM_POOL_AUTH:di,CREATE_CPMM_POOL_FEE_ACC:fi,FEE_DESTINATION_ID:new M("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR"),LOCK_CPMM_PROGRAM:pi,LCOK_CPMM_AUTH:mi};import oc from"bn.js";import{PublicKey as cn,AddressLookupTableAccount as Pt}from"@solana/web3.js";async function Qt({connection:e,address:t}){let r=await Kr(e,[...new Set(t.map(o=>o.toString()))].map(o=>new cn(o))),n={};for(let o=0;o<t.length;o++){let i=r[o],s=t[o];if(!i)continue;let a=new Pt({key:s,state:Pt.deserialize(i.data)});n[s.toString()]=a,Tt[s.toString()]=a}return n}var Tt={"2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17":new Pt({key:new cn("2immgwYNHBbyVQKVGCEkgWpi53bLwWNRMB5G2nbgYV17"),state:Pt.deserialize(Buffer.from("AQAAAP//////////d49+DAAAAAAAAQZMWvw7GUNJdaccNBVnb57OKakxL2BHLYvhRwVILRsgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMGRm/lIRcy/+ytunLDm+e8jOW7xfcSayxDmzpAAAAABt324ddloZPZy+FGzut5rBy0he1fWzeROoz1hX7/AKkG3fbh7nWP3hhCXbzkbM3athr8TYO5DSf+vfko2KGL/AVKU1D4XciC1hSlVnJ4iilt3x6rq9CmBniISTL07vagBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvDQdRqCgtphMF/imcN7mY5YRx2xE1A3MQ+L4QRaYK9u4GRfZP3LsAd00a+IkCpA22UNQMKdq5BFbJuwuOLqc8zxCTDlqxBG8J0HcxtfogQHDK06ukzfaXiNDKAob1MqBHS9lJxDYCwz8gd5DtFqNSTKG5l1zxIaKpDP/sffi2is1H9aKveyXSu5StXElYRl9SD5As0DHE4N0GLnf84/siiKXVyp4Ez121kLcUui/jLLFZEz/BwZK3Ilf9B9OcsEAeDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu9N9LMnrw/JNO0hqMVB4rk/2ou4AB1loQ7FZoPwut2o4KZB+0p9xnbrQKw038qjpHar+PyDwvxBRcu5hpHw3dguezeWv+IwvgW5icu8EGkhGa9AkFPPJT7VMSFb8xowveU=","base64"))})};import{PublicKey as Ze,sendAndConfirmTransaction as Jt,Transaction as Xe,TransactionMessage as Qe,VersionedTransaction as Je}from"@solana/web3.js";import yi from"axios";var kt=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner,this.cluster=t.cluster,this.blockhashCommitment=t.blockhashCommitment,this.api=t.api}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var n;let t=(await yi.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:r}=(n=t==null?void 0:t[15])!=null?n:{};if(!!r)return{units:6e5,microLamports:Math.min(Math.ceil(r*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:r,instructionTypes:n}=wt(t);return this.instructions.unshift(...r),this.instructionTypes.unshift(...n),!0}return!1}async calComputeBudget({config:t,defaultIns:r}){try{let n=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(n))return;r&&this.instructions.unshift(...r)}catch{r&&this.instructions.unshift(...r)}}addInstruction({instructions:t=[],endInstructions:r=[],signers:n=[],instructionTypes:o=[],endInstructionTypes:i=[],lookupTableAddress:s=[]}){return this.instructions.push(...t),this.endInstructions.push(...r),this.signers.push(...n),this.instructionTypes.push(...o),this.endInstructionTypes.push(...i),this.lookupTableAddress.push(...s.filter(a=>a!==Ze.default.toString())),this}async versionBuild({txVersion:t,extInfo:r}){return t===0?await this.buildV0(Y({},r||{})):this.build(r)}build(t){var n;let r=new Xe;return this.allInstructions.length&&r.add(...this.allInstructions),r.feePayer=this.feePayer,((n=this.owner)==null?void 0:n.signer)&&!this.signers.some(o=>o.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:r,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async o=>{var u;let{recentBlockHash:i,skipPreflight:s=!0,sendAndConfirm:a}=o||{},c=i!=null?i:await ve(this.connection,this.blockhashCommitment);if(r.recentBlockhash=c,this.signers.length&&r.sign(...this.signers),Me([r]),(u=this.owner)!=null&&u.isKeyPair)return{txId:a?await Jt(this.connection,r,this.signers.find(d=>d.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(r.serialize(),{skipPreflight:s}),signedTx:r};if(this.signAllTransactions){let l=await this.signAllTransactions([r]);return{txId:await this.connection.sendRawTransaction(l[0].serialize(),{skipPreflight:s}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:t||{}}}buildMultiTx(t){var u;let{extraPreBuildData:r=[],extInfo:n}=t,{transaction:o}=this.build(n),i=r.filter(l=>l.transaction.instructions.length>0),s=[o,...i.map(l=>l.transaction)],a=[this.signers,...i.map(l=>l.signers)],c=[...this.instructionTypes,...i.map(l=>l.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(l=>{l.some(d=>d.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:c,execute:async l=>{var T;let{sequentially:d,onTxUpdate:f,skipTxCount:p=0,recentBlockHash:g,skipPreflight:y=!0}=l||{},x=g!=null?g:await ve(this.connection,this.blockhashCommitment);if((T=this.owner)!=null&&T.isKeyPair){if(d){let k=[],b=0;for(let w of s){if(++b,b<=p)continue;let A=await Jt(this.connection,w,this.signers.find(I=>I.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:y});k.push(A)}return{txIds:k,signedTxs:s}}return{txIds:await await Promise.all(s.map(async k=>(k.recentBlockhash=x,await this.connection.sendRawTransaction(k.serialize(),{skipPreflight:y})))),signedTxs:s}}if(this.signAllTransactions){let k=s.map((w,A)=>(w.recentBlockhash=x,a[A].length&&w.sign(...a[A]),w));Me(k);let b=await this.signAllTransactions(k);if(d){let w=0,A=[],I=async()=>{if(!b[w])return;let F=await this.connection.sendRawTransaction(b[w].serialize(),{skipPreflight:y});A.push({txId:F,status:"sent",signedTx:b[w]}),f==null||f([...A]),w++,this.connection.onSignature(F,G=>{let B=A.findIndex(K=>K.txId===F);B>-1&&(A[B].status=G.err?"error":"success"),f==null||f([...A]),G.err||I()},"processed"),this.connection.getSignatureStatus(F)};return await I(),{txIds:A.map(F=>F.txId),signedTxs:b}}else{let w=[];for(let A=0;A<b.length;A+=1){let I=await this.connection.sendRawTransaction(b[A].serialize(),{skipPreflight:y});w.push(I)}return{txIds:w,signedTxs:b}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:r,extInfo:n}){return r===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:n||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:n})}async buildV0(t){var y;let g=t||{},{lookupTableCache:r={},lookupTableAddress:n=[],forerunCreate:o,recentBlockhash:i}=g,s=at(g,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),a=Y(Y({},this.cluster==="devnet"?{}:Tt),r),c=Array.from(new Set([...n,...this.lookupTableAddress])),u=[];for(let x of c)a[x]===void 0&&u.push(new Ze(x));let l=await Qt({connection:this.connection,address:u});for(let[x,T]of Object.entries(l))a[x]=T;let d=o?Ze.default.toBase58():i!=null?i:await ve(this.connection,this.blockhashCommitment),f=new Qe({payerKey:this.feePayer,recentBlockhash:d,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(a));((y=this.owner)==null?void 0:y.signer)&&!this.signers.some(x=>x.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let p=new Je(f);return p.sign(this.signers),{builder:this,transaction:p,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async x=>{var b;let{skipPreflight:T=!0,sendAndConfirm:k}=x||{};if(Me([p]),(b=this.owner)!=null&&b.isKeyPair){let w=await this.connection.sendTransaction(p,{skipPreflight:T});return k&&await xt(this.connection,w),{txId:w,signedTx:p}}if(this.signAllTransactions){let w=await this.signAllTransactions([p]);return{txId:await this.connection.sendTransaction(w[0],{skipPreflight:T}),signedTx:w[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(t){var u;let{extraPreBuildData:r=[],buildProps:n}=t,{transaction:o}=await this.buildV0(n),i=r.filter(l=>l.builder.instructions.length>0),s=[o,...i.map(l=>l.transaction)],a=[this.signers,...i.map(l=>l.signers)],c=[...this.instructionTypes,...i.map(l=>l.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(l=>{l.some(d=>d.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(l,d)=>{l.sign(a[d])}),{builder:this,transactions:s,signers:a,instructionTypes:c,buildProps:n,execute:async l=>{var y;let{sequentially:d,onTxUpdate:f,recentBlockHash:p,skipPreflight:g=!0}=l||{};if(p&&s.forEach(x=>x.message.recentBlockhash=p),Me(s),(y=this.owner)!=null&&y.isKeyPair){if(d){let x=[];for(let T of s){let k=await this.connection.sendTransaction(T,{skipPreflight:g});await xt(this.connection,k),x.push(k)}return{txIds:x,signedTxs:s}}return{txIds:await Promise.all(s.map(async x=>await this.connection.sendTransaction(x,{skipPreflight:g}))),signedTxs:s}}if(this.signAllTransactions){let x=await this.signAllTransactions(s);if(d){let T=0,k=[],b=async()=>{if(!x[T])return;let w=await this.connection.sendTransaction(x[T],{skipPreflight:g});k.push({txId:w,status:"sent",signedTx:x[T]}),f==null||f([...k]),T++,this.connection.onSignature(w,A=>{let I=k.findIndex(F=>F.txId===w);I>-1&&(k[I].status=A.err?"error":"success"),f==null||f([...k]),A.err||b()},"processed"),this.connection.getSignatureStatus(w)};return b(),{txIds:[],signedTxs:x}}else{let T=[];for(let k=0;k<x.length;k+=1){let b=await this.connection.sendTransaction(x[k],{skipPreflight:g});T.push(b)}return{txIds:T,signedTxs:x}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async sizeCheckBuild(t){var l;let u=t||{},{computeBudgetConfig:r}=u,n=at(u,["computeBudgetConfig"]),o=r?wt(r):{instructions:[],instructionTypes:[]},i=this.signers.reduce((d,f)=>te(Y({},d),{[f.publicKey.toBase58()]:f}),{}),s=[],a=[],c=[];if(this.allInstructions.forEach(d=>{let f=[...c,d],p=r?[...o.instructions,...f]:f,y=[...new Set(f.map(x=>x.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat()).values()].map(x=>new Ze(x));if(c.length<12&&je({instructions:p,payer:this.feePayer,signers:y})||je({instructions:f,payer:this.feePayer,signers:y}))c.push(d);else{if(c.length===0)throw Error("item ins too big");je({instructions:r?[...o.instructions,...c]:[...c],payer:this.feePayer,signers:y})?s.push(new Xe().add(...o.instructions,...c)):s.push(new Xe().add(...c)),a.push(Array.from(new Set(c.map(x=>x.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat())).map(x=>i[x]).filter(x=>x!==void 0)),c=[d]}}),c.length>0){let f=[...new Set(c.map(p=>p.keys.filter(g=>g.isSigner).map(g=>g.pubkey.toString())).flat()).values()].map(p=>i[p]).filter(p=>p!==void 0);je({instructions:r?[...o.instructions,...c]:[...c],payer:this.feePayer,signers:f.map(p=>p.publicKey)})?s.push(new Xe().add(...o.instructions,...c)):s.push(new Xe().add(...c)),a.push(f)}return s.forEach(d=>d.feePayer=this.feePayer),(l=this.owner)!=null&&l.signer&&a.forEach(d=>{d.some(f=>f.publicKey.equals(this.owner.publicKey))||d.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:this.instructionTypes,execute:async d=>{var k;let{sequentially:f,onTxUpdate:p,skipTxCount:g=0,recentBlockHash:y,skipPreflight:x=!0}=d||{},T=y!=null?y:await ve(this.connection,this.blockhashCommitment);if(s.forEach(async(b,w)=>{b.recentBlockhash=T,a[w].length&&b.sign(...a[w])}),Me(s),(k=this.owner)!=null&&k.isKeyPair){if(f){let b=0,w=[];for(let A of s){if(++b,b<=g){w.push("tx skipped");continue}let I=await Jt(this.connection,A,this.signers.find(F=>F.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:x});w.push(I)}return{txIds:w,signedTxs:s}}return{txIds:await Promise.all(s.map(async b=>await this.connection.sendRawTransaction(b.serialize(),{skipPreflight:x}))),signedTxs:s}}if(this.signAllTransactions){let b=await this.signAllTransactions(s.slice(g,s.length)),w=[...s.slice(0,g),...b];if(f){let A=0,I=[],F=async()=>{if(!w[A])return;A<g&&(I.push({txId:"",status:"success",signedTx:w[A]}),p==null||p([...I]),A++,F());let G=await this.connection.sendRawTransaction(w[A].serialize(),{skipPreflight:x});I.push({txId:G,status:"sent",signedTx:w[A]}),p==null||p([...I]),A++,this.connection.onSignature(G,B=>{let K=I.findIndex(v=>v.txId===G);K>-1&&(I[K].status=B.err?"error":"success"),p==null||p([...I]),B.err||F()},"processed"),this.connection.getSignatureStatus(G)};return await F(),{txIds:I.map(G=>G.txId),signedTxs:w}}else{let A=[];for(let I=0;I<w.length;I+=1){let F=await this.connection.sendRawTransaction(w[I].serialize(),{skipPreflight:x});A.push(F)}return{txIds:A,signedTxs:w}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async sizeCheckBuildV0(t){var T;let x=t||{},{computeBudgetConfig:r,lookupTableCache:n={},lookupTableAddress:o=[]}=x,i=at(x,["computeBudgetConfig","lookupTableCache","lookupTableAddress"]),s=Y(Y({},this.cluster==="devnet"?{}:Tt),n),a=Array.from(new Set([...this.lookupTableAddress,...o])),c=[];for(let k of a)s[k]===void 0&&c.push(new Ze(k));let u=await Qt({connection:this.connection,address:c});for(let[k,b]of Object.entries(u))s[k]=b;let l=r?wt(r):{instructions:[],instructionTypes:[]},d=await ve(this.connection,this.blockhashCommitment),f=this.signers.reduce((k,b)=>te(Y({},k),{[b.publicKey.toBase58()]:b}),{}),p=[],g=[],y=[];if(this.allInstructions.forEach(k=>{let b=[...y,k],w=r?[...l.instructions,...b]:b;if(y.length<12&&ze({instructions:w,payer:this.feePayer,lookupTableAddressAccount:s})||ze({instructions:b,payer:this.feePayer,lookupTableAddressAccount:s}))y.push(k);else{if(y.length===0)throw Error("item ins too big");let A={};for(let I of[...new Set(a)])s[I]!==void 0&&(A[I]=s[I]);if(r&&ze({instructions:[...l.instructions,...y],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:d})){let I=new Qe({payerKey:this.feePayer,recentBlockhash:d,instructions:[...l.instructions,...y]}).compileToV0Message(Object.values(s));p.push(new Je(I))}else{let I=new Qe({payerKey:this.feePayer,recentBlockhash:d,instructions:[...y]}).compileToV0Message(Object.values(s));p.push(new Je(I))}g.push(Array.from(new Set(y.map(I=>I.keys.filter(F=>F.isSigner).map(F=>F.pubkey.toString())).flat())).map(I=>f[I]).filter(I=>I!==void 0)),y=[k]}}),y.length>0){let b=[...new Set(y.map(w=>w.keys.filter(A=>A.isSigner).map(A=>A.pubkey.toString())).flat()).values()].map(w=>f[w]).filter(w=>w!==void 0);if(r&&ze({instructions:[...l.instructions,...y],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:d})){let w=new Qe({payerKey:this.feePayer,recentBlockhash:d,instructions:[...l.instructions,...y]}).compileToV0Message(Object.values(s));p.push(new Je(w))}else{let w=new Qe({payerKey:this.feePayer,recentBlockhash:d,instructions:[...y]}).compileToV0Message(Object.values(s));p.push(new Je(w))}g.push(b)}return(T=this.owner)!=null&&T.signer&&g.forEach(k=>{k.some(b=>b.publicKey.equals(this.owner.publicKey))||k.push(this.owner.signer)}),{builder:this,transactions:p,buildProps:t,signers:g,instructionTypes:this.instructionTypes,execute:async k=>{var G;let{sequentially:b,onTxUpdate:w,skipTxCount:A=0,recentBlockHash:I,skipPreflight:F=!0}=k||{};if(p.map(async(B,K)=>{g[K].length&&B.sign(g[K]),I&&(B.message.recentBlockhash=I)}),Me(p),(G=this.owner)!=null&&G.isKeyPair){if(b){let B=0,K=[];for(let v of p){if(++B,B<=A){console.log("skip tx: ",B),K.push("tx skipped");continue}let O=await this.connection.sendTransaction(v,{skipPreflight:F});await xt(this.connection,O),K.push(O)}return{txIds:K,signedTxs:p}}return{txIds:await Promise.all(p.map(async B=>await this.connection.sendTransaction(B,{skipPreflight:F}))),signedTxs:p}}if(this.signAllTransactions){let B=await this.signAllTransactions(p.slice(A,p.length)),K=[...p.slice(0,A),...B];if(b){let v=0,O=[],E=async()=>{if(!K[v])return;if(v<A){O.push({txId:"",status:"success",signedTx:K[v]}),w==null||w([...O]),v++,E();return}let ee=await this.connection.sendTransaction(K[v],{skipPreflight:F});O.push({txId:ee,status:"sent",signedTx:K[v]}),w==null||w([...O]),v++,this.connection.onSignature(ee,z=>{let W=O.findIndex(it=>it.txId===ee);W>-1&&(O[W].status=z.err?"error":"success"),w==null||w([...O]),z.err||E()},"processed"),this.connection.getSignatureStatus(ee)};return E(),{txIds:[],signedTxs:K}}else{let v=[];for(let O=0;O<K.length;O+=1){let E=await this.connection.sendTransaction(K[O],{skipPreflight:F});v.push(E)}return{txIds:v,signedTxs:K}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}};import{Keypair as Ki,PublicKey as Ci}from"@solana/web3.js";import rd from"bn.js";import{TOKEN_PROGRAM_ID as Vi}from"@solana/spl-token";function hi(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function $t(e,...t){if(!hi(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function er(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ln(e,t){$t(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}var It=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),fe=(e,t)=>e<<32-t|e>>>t;var Wc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function bi(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function tr(e){return typeof e=="string"&&(e=bi(e)),$t(e),e}var At=class{clone(){return this._cloneInto()}},Uc={}.toString;function dn(e){let t=n=>e().update(tr(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function wi(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),i=BigInt(4294967295),s=Number(r>>o&i),a=Number(r&i),c=n?4:0,u=n?0:4;e.setUint32(t+c,s,n),e.setUint32(t+u,a,n)}var fn=(e,t,r)=>e&t^~e&r,pn=(e,t,r)=>e&t^e&r^t&r,St=class extends At{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=It(this.buffer)}update(t){er(this);let{view:r,buffer:n,blockLen:o}=this;t=tr(t);let i=t.length;for(let s=0;s<i;){let a=Math.min(o-this.pos,i-s);if(a===o){let c=It(t);for(;o<=i-s;s+=o)this.process(c,s);continue}n.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){er(this),ln(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:i}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>o-s&&(this.process(n,0),s=0);for(let d=s;d<o;d++)r[d]=0;wi(n,o-8,BigInt(this.length*8),i),this.process(n,0);let a=It(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:i,destroyed:s,pos:a}=this;return t.length=o,t.pos=a,t.finished=i,t.destroyed=s,o%r&&t.buffer.set(n),t}};var xi=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Be=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Re=new Uint32Array(64),rr=class extends St{constructor(){super(64,32,8,!1),this.A=Be[0]|0,this.B=Be[1]|0,this.C=Be[2]|0,this.D=Be[3]|0,this.E=Be[4]|0,this.F=Be[5]|0,this.G=Be[6]|0,this.H=Be[7]|0}get(){let{A:t,B:r,C:n,D:o,E:i,F:s,G:a,H:c}=this;return[t,r,n,o,i,s,a,c]}set(t,r,n,o,i,s,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=i|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,r){for(let d=0;d<16;d++,r+=4)Re[d]=t.getUint32(r,!1);for(let d=16;d<64;d++){let f=Re[d-15],p=Re[d-2],g=fe(f,7)^fe(f,18)^f>>>3,y=fe(p,17)^fe(p,19)^p>>>10;Re[d]=y+Re[d-7]+g+Re[d-16]|0}let{A:n,B:o,C:i,D:s,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){let f=fe(a,6)^fe(a,11)^fe(a,25),p=l+f+fn(a,c,u)+xi[d]+Re[d]|0,y=(fe(n,2)^fe(n,13)^fe(n,22))+pn(n,o,i)|0;l=u,u=c,c=a,a=s+p|0,s=i,i=o,o=n,n=p+y|0}n=n+this.A|0,o=o+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,o,i,s,a,c,u,l)}roundClean(){Re.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var mn=dn(()=>new rr);import{PublicKey as Li}from"@solana/web3.js";import bn,{isBN as wn}from"bn.js";import{bits as Qc,BitStructure as Jc,blob as Pi,Blob as $c,cstr as el,f32 as tl,f32be as rl,f64 as nl,f64be as ol,greedy as il,Layout as Ti,ns64 as sl,ns64be as al,nu64 as ul,nu64be as cl,offset as ll,s16 as dl,s16be as fl,s24 as pl,s24be as ml,s32 as gl,s32be as yl,s40 as hl,s40be as bl,s48 as wl,s48be as xl,s8 as Pl,seq as ki,struct as Tl,Structure as Ai,u16 as kl,u16be as Al,u24 as Il,u24be as Sl,u32 as Ll,u32be as Bl,u40 as Rl,u40be as Kl,u48 as Cl,u48be as Vl,u8 as Ii,UInt as Si,union as Ml,Union as Fl,unionLayoutDiscriminator as El,utf8 as Nl}from"@solana/buffer-layout";var nr=Ti,gn=Ai;var or=Si;var yn=Ii;var hn=ki;var Fe=Pi;var Oe=class extends nr{constructor(r,n,o){super(r,o);this.blob=Fe(r),this.signed=n}decode(r,n=0){let o=new bn(this.blob.decode(r,n),10,"le");return this.signed?o.fromTwos(this.span*8).clone():o}encode(r,n,o=0){return typeof r=="number"&&(r=new bn(r)),this.signed&&(r=r.toTwos(this.span*8)),this.blob.encode(r.toArrayLike(Buffer,"le",this.span),n,o)}};function $(e){return new or(1,e)}function $e(e){return new or(4,e)}function P(e){return new Oe(8,!1,e)}function Pe(e){return new Oe(16,!1,e)}function xn(e){return new Oe(1,!0,e)}function Bt(e){return new Oe(8,!0,e)}var Lt=class extends nr{constructor(r,n,o,i){super(r.span,i);this.layout=r,this.decoder=n,this.encoder=o}decode(r,n){return this.decoder(this.layout.decode(r,n))}encode(r,n,o){return this.layout.encode(this.encoder(r),n,o)}getSpan(r,n){return this.layout.getSpan(r,n)}};function _(e){return new Lt(Fe(32),t=>new Li(t),t=>t.toBuffer(),e)}function Rt(e){return new Lt(yn(),Bi,Ri,e)}function Bi(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function Ri(e){return e?1:0}var ir=class extends gn{decode(t,r){return super.decode(t,r)}};function Z(e,t,r){return new ir(e,t,r)}function Q(e,t,r){let n,o=typeof t=="number"?t:wn(t)?t.toNumber():new Proxy(t,{get(i,s){if(!n){let a=Reflect.get(i,"count");n=wn(a)?a.toNumber():a,Reflect.set(i,"count",n)}return Reflect.get(i,s)},set(i,s,a){return s==="count"&&(n=a),Reflect.set(i,s,a)}});return hn(e,o,r)}var et=Z([_("mint"),_("owner"),P("amount"),$e("delegateOption"),_("delegate"),$("state"),$e("isNativeOption"),P("isNative"),P("delegatedAmount"),$e("closeAuthorityOption"),_("closeAuthority")]);var ad=J("Raydium_Util");function Kt({fromPublicKey:e,programId:t=Vi,assignSeed:r}){let n=r?btoa(r).slice(0,32):Ki.generate().publicKey.toBase58().slice(0,32);return{publicKey:Mi(e,n,t),seed:n}}function Mi(e,t,r){let n=Buffer.concat([e.toBuffer(),Buffer.from(t),r.toBuffer()]),o=mn(n);return new Ci(o)}import{PublicKey as Fi,SystemProgram as Ei}from"@solana/web3.js";import Ni from"bn.js";import{createCloseAccountInstruction as _i,createInitializeAccountInstruction as vi,createTransferInstruction as bd,TOKEN_PROGRAM_ID as tt}from"@solana/spl-token";function Di(e){let{mint:t,tokenAccount:r,owner:n,programId:o=tt}=e;return vi(r,t,n,o)}function Oi(e){let{tokenAccount:t,payer:r,multiSigners:n=[],owner:o,programId:i=tt}=e;return _i(t,r,o,n,i)}async function sr(e){let{connection:t,amount:r,commitment:n,payer:o,owner:i,skipCloseAccount:s}=e,a=await t.getMinimumBalanceForRentExemption(et.span,n),c=N(r).add(new Ni(a)),u=Kt({fromPublicKey:o,programId:tt});return{addresses:{newAccount:u.publicKey},signers:[],instructions:[Ei.createAccountWithSeed({fromPubkey:o,basePubkey:o,seed:u.seed,newAccountPubkey:u.publicKey,lamports:c.toNumber(),space:et.span,programId:tt}),Di({mint:new Fi(se.address),tokenAccount:u.publicKey,owner:i,programId:tt})],instructionTypes:[j.CreateAccount,j.InitAccount],endInstructionTypes:s?[]:[j.CloseAccount],endInstructions:s?[]:[Oi({tokenAccount:u.publicKey,payer:o,owner:i})]}}var ar=(...e)=>e.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),rt=class{constructor({scope:t,moduleName:r}){this.disabled=!1;this.scope=t,this.logger=J(r)}createTxBuilder(t){return this.scope.checkOwner(),new kt({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(ar(t))}logInfo(...t){this.logger.info(ar(t))}logAndCreateError(...t){let r=ar(t);throw new Error(r)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{PublicKey as kn}from"@solana/web3.js";var ur=Z([$("instruction")]),cr=Z([$("instruction")]),Wi=Z([P("rewardState"),P("rewardOpenTime"),P("rewardEndTime"),P("rewardLastUpdateTime"),P("totalReward"),P("totalRewardEmissioned"),P("rewardClaimed"),P("rewardPerSecond"),Pe("accRewardPerShare"),_("rewardVault"),_("rewardMint"),_("rewardSender"),P("rewardType"),Q(P(),15,"padding")]),Ui=Z([P("state"),P("nonce"),_("lpVault"),_("rewardVault"),_(),_(),P(),P(),P("totalReward"),Pe("perShareReward"),P("lastSlot"),P("perSlotReward")]),qi=Z([P("state"),P("nonce"),_("lpVault"),_("rewardVaultA"),P("totalRewardA"),Pe("perShareRewardA"),P("perSlotRewardA"),$("option"),_("rewardVaultB"),Fe(7),P("totalRewardB"),Pe("perShareRewardB"),P("perSlotRewardB"),P("lastSlot"),_()]),Gi=Z([P(),P("state"),P("nonce"),P("validRewardTokenNum"),Pe("rewardMultiplier"),P("rewardPeriodMax"),P("rewardPeriodMin"),P("rewardPeriodExtend"),_("lpMint"),_("lpVault"),Q(Wi,5,"rewardInfos"),_("creator"),_(),Q(P(),32,"padding")]),Hi=new Proxy(Ui,{get(e,t,r){return t==="decode"?(...n)=>{let o=e.decode(...n);return te(Y({},o),{version:3,rewardInfos:[{rewardVault:o.rewardVault,totalReward:o.totalReward,perSlotReward:o.perSlotReward,perShareReward:o.perShareReward}]})}:Reflect.get(e,t,r)}}),ji=new Proxy(qi,{get(e,t,r){return t==="decode"?(...n)=>{let o=e.decode(...n);return te(Y({},o),{version:5,rewardInfos:[{rewardVault:o.rewardVaultA,totalReward:o.totalRewardA,perSlotReward:o.perSlotRewardA,perShareReward:o.perShareRewardA},{rewardVault:o.rewardVaultB,totalReward:o.totalRewardB,perSlotReward:o.perSlotRewardB,perShareReward:o.perShareRewardB}]})}:Reflect.get(e,t,r)}}),Ct=new Proxy(Gi,{get(e,t,r){return t==="decode"?(...n)=>{let o=e.decode(...n);return te(Y({},o),{version:6,rewardInfos:o.rewardInfos.map(i=>{var s;return te(Y({},i),{rewardType:((s=Object.entries(Ke).find(a=>String(a[1])===i.rewardType.toString()))!=null?s:["Standard SPL"])[0]})})})}:Reflect.get(e,t,r)}}),zi=Z([P("isSet"),P("rewardPerSecond"),P("rewardOpenTime"),P("rewardEndTime"),P("rewardType")]),lr=Z([$("instruction"),P("nonce"),Q(zi,5,"rewardTimeInfo")]),dr=Z([$("instruction"),P("rewardReopenTime"),P("rewardEndTime"),P("rewardPerSecond")]),fr=Z([$("instruction"),P("isSet"),P("rewardPerSecond"),P("rewardOpenTime"),P("rewardEndTime"),P("rewardType")]),Md=Z([P("state"),_("id"),_("owner"),P("deposited"),Q(P(),1,"rewardDebts")]),pr=Z([P("state"),_("id"),_("owner"),P("deposited"),Q(Pe(),1,"rewardDebts"),P(""),P("voteLockedBalance"),Q(P(),15)]),Fd=Z([P("state"),_("id"),_("owner"),P("deposited"),Q(P(),2,"rewardDebts")]),Pn=Z([P("state"),_("id"),_("owner"),P("deposited"),Q(Pe(),2,"rewardDebts"),Q(P(),17)]),Tn=Z([P(),P("state"),_("id"),_("owner"),P("deposited"),Q(Pe(),5,"rewardDebts"),Q(P(),16)]),ue=Z([$("instruction"),P("amount")]),Yi=Z([_("mint"),_("grantAuthority"),P("baselineVoteWeightScaledFactor"),P("maxExtraLockupVoteWeightScaledFactor"),P("lockupSaturationSecs"),xn("digitShift"),Q($(),7,"reserved1"),Q(P(),7,"reserved2")]),Zi=Z([Fe(8),_("governanceProgramId"),_("realm"),_("realmGoverningTokenMint"),_("realmAuthority"),Q($(),32,"reserved1"),Q(Yi,4,"votingMints"),Bt("timeOffset"),$("bump"),Q($(),7,"reserved2"),Q(P(),11,"reserved3")]),Xi=Z([Bt("startTime"),Bt("endTime"),$("kind"),Q($(),15,"reserved")]),Qi=Z([Q(Xi,1,"lockup"),P("amountDeposited_native"),P("amountInitiallyLockedNative"),Rt("isUsed"),Rt("allowClawback"),$("votingMintConfigIdx"),Q($(),29,"reserved")]),Ji=Z([Fe(8),_("voterAuthority"),_("registrar"),Q(Qi,32,"deposits"),$("voterBump"),$("voterWweightRecordBump"),Q($(),94,"reserved")]);var Ud=J("Raydium_farm_config"),An=new kn("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),In=new kn("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1");var Sn={3:pr,5:Pn,6:Tn},mr=e=>[3,4,5,6].indexOf(e)!==-1,gr=e=>{var s;let{version:t,rewardInfos:r,rewardTokenAccountsPublicKeys:n}=e,o=`rewardInfo:${JSON.stringify(r)}, rewardAccount:${JSON.stringify(n)}`,i={3:()=>{if(r.length!==1||n.length!==1)return`rewardInfos or rewardTokenAccounts lengths not equal 1: ${o}`},5:()=>{if(r.length!==n.length)return`rewardInfos and rewardTokenAccounts lengths not equal: ${o}`},6:()=>{if(!n.length||r.length!==n.length)return`no rewardTokenAccounts or rewardInfos and rewardTokenAccounts lengths not equal: ${o}`}};return(s=i[t])==null?void 0:s.call(i)},Ke={"Standard SPL":0,"Option tokens":1},Te={[sn.toString()]:3,[an.toString()]:4,[un.toString()]:5,[Ye.toString()]:6};import{PublicKey as D,SystemProgram as Rn,SYSVAR_CLOCK_PUBKEY as ot,SYSVAR_RENT_PUBKEY as ts,TransactionInstruction as ce}from"@solana/web3.js";import Kn from"bn.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as Tf,createAssociatedTokenAccountInstruction as kf,TOKEN_PROGRAM_ID as ke}from"@solana/spl-token";import $i from"bn.js";var es=J("Raydium.farm.util");function nt({programId:e,poolId:t,mint:r,type:n}){let{publicKey:o}=Ve([t.toBuffer(),r.toBuffer(),Buffer.from(n==="lpVault"?"lp_vault_associated_seed":n==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],e);return o}function me({programId:e,poolId:t,owner:r,version:n}){let{publicKey:o}=Ve([t.toBuffer(),r.toBuffer(),Buffer.from(n===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],e);return o}var Ln=({programId:e,poolId:t})=>Ve([t.toBuffer()],e);function Bn(e){return{isSet:new $i(1),rewardPerSecond:N(e.perSecond),rewardOpenTime:N(e.openTime),rewardEndTime:N(e.endTime),rewardType:N(Ke[e.rewardType])}}function yr(e){return N(e.endTime).sub(N(e.openTime)).mul(N(e.perSecond))}function hr(e){let t=Sn[e];return t||es.logWithError("invalid version",e),t}var rs=J("Raydium_farm_instruction"),Ff={voterStakeRegistryCreateVoter:Buffer.from([6,24,245,52,243,255,148,25]),voterStakeRegistryCreateDepositEntry:Buffer.from([185,131,167,186,159,125,19,67]),voterStakeRegistryDeposit:Buffer.from([242,35,198,137,82,225,242,182]),voterStakeRegistryWithdraw:Buffer.from([183,18,70,156,148,109,161,34]),voterStakeRegistryUpdateVoterWeightRecord:Buffer.from([45,185,3,36,109,190,115,169])};function br(e){let{version:t,id:r,ledger:n,programId:o,owner:i}=e,s={3:9,5:10}[t];s||rs.logWithError(`invalid farm pool version: ${t}`);let a=Buffer.alloc(ur.span);ur.encode({instruction:s},a);let c=[m({pubkey:r}),m({pubkey:n}),m({pubkey:i,isWritable:!1}),m({pubkey:Rn.programId,isWritable:!1}),m({pubkey:ts,isWritable:!1})];return{instruction:new ce({programId:o,keys:c,data:a}),instructionType:j.FarmV3CreateLedger}}function Cn(e){var n;let t=Buffer.alloc(lr.span);lr.encode({instruction:0,nonce:new Kn(e.nonce),rewardTimeInfo:e.rewardInfoConfig},t);let r=[...Gt,m({pubkey:e.farmId}),m({pubkey:e.farmAuthority,isWritable:!1}),m({pubkey:e.lpVault}),m({pubkey:e.lpMint,isWritable:!1}),m({pubkey:e.lockVault}),m({pubkey:e.lockMint,isWritable:!1}),m({pubkey:(n=e.lockUserAccount)!=null?n:ne}),m({pubkey:e.owner,isWritable:!1,isSigner:!0})];for(let o of e.rewardInfo)r.push(m({pubkey:o.rewardMint,isWritable:!1}),m({pubkey:o.rewardVault}),m({pubkey:o.userRewardToken}));return{instruction:new ce({programId:e.programId,keys:r,data:t}),instructionType:j.FarmV6Create}}function Vn(e){let t=Buffer.alloc(cr.span);cr.encode({instruction:5},t);let r=[m({pubkey:ke,isWritable:!1}),m({pubkey:e.id}),m({pubkey:e.authority,isWritable:!1}),m({pubkey:e.lpVault,isWritable:!1}),m({pubkey:e.rewardVault}),m({pubkey:e.userRewardToken}),m({pubkey:e.owner,isWritable:!1,isSigner:!0})];return{instruction:new ce({programId:e.programId,keys:r,data:t}),instructionType:j.FarmV6CreatorWithdraw}}function wr({payer:e,rewardVault:t,userRewardTokenPub:r,farmKeys:n,rewardInfo:o}){let i=Buffer.alloc(dr.span);dr.encode({instruction:3,rewardReopenTime:N(o.openTime),rewardEndTime:N(o.endTime),rewardPerSecond:N(o.perSecond)},i);let s=[m({pubkey:ke,isWritable:!1}),m({pubkey:n.id}),m({pubkey:n.lpVault,isWritable:!1}),m({pubkey:t}),m({pubkey:r}),m({pubkey:e,isWritable:!1,isSigner:!0})];return new ce({programId:n.programId,keys:s,data:i})}function xr({payer:e,userRewardTokenPub:t,farmKeys:r,rewardVault:n,rewardInfo:o}){let i=Buffer.alloc(fr.span);fr.encode({instruction:4,isSet:new Kn(1),rewardPerSecond:N(o.perSecond),rewardOpenTime:N(o.openTime),rewardEndTime:N(o.endTime),rewardType:N(Ke[o.rewardType])},i);let s=[...Gt,m({pubkey:r.id}),m({pubkey:r.authority,isWritable:!1}),m({pubkey:o.mint,isWritable:!1}),m({pubkey:n}),m({pubkey:t}),m({pubkey:e,isWritable:!1,isSigner:!0})];return new ce({programId:r.programId,keys:s,data:i})}function Pr(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s}=e,[a,c]=[new D(t.programId),new D(t.id)],u=me({programId:a,poolId:c,owner:i,version:6}),l=Buffer.alloc(ue.span);ue.encode({instruction:2,amount:N(s)},l);let d=[m({pubkey:ke,isWritable:!1}),m({pubkey:c}),m({pubkey:new D(r.authority),isWritable:!1}),m({pubkey:new D(r.lpVault)}),m({pubkey:u}),m({pubkey:i,isWritable:!1,isSigner:!0}),m({pubkey:n})];for(let f=0;f<r.rewardInfos.length;f++)d.push(m({pubkey:new D(r.rewardInfos[f].vault)})),d.push(m({pubkey:o[f]}));return new ce({programId:a,keys:d,data:l})}function Tr(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=me({programId:c,poolId:u,owner:i,version:5}),d=Buffer.alloc(ue.span);ue.encode({instruction:12,amount:N(s)},d);let f=[m({pubkey:u}),m({pubkey:new D(r.authority),isWritable:!1}),m({pubkey:l}),m({pubkey:i,isWritable:!1,isSigner:!0}),m({pubkey:n}),m({pubkey:new D(r.lpVault)}),m({pubkey:o[0]}),m({pubkey:new D(r.rewardInfos[0].vault)}),m({pubkey:ot,isWritable:!1}),m({pubkey:ke,isWritable:!1})];for(let p=1;p<r.rewardInfos.length;p++)f.push(m({pubkey:o[p]})),f.push(m({pubkey:new D(r.rewardInfos[p].vault)}));if(a)for(let p of a)f.push(m({pubkey:p}));return new ce({programId:c,keys:f,data:d})}function Mn(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=Z([$("instruction"),P("amount")]),d=[m({pubkey:u}),m({pubkey:new D(r.authority),isWritable:!1}),m({pubkey:a[0]}),m({pubkey:i,isSigner:!0,isWritable:!1}),m({pubkey:n}),m({pubkey:new D(r.lpVault)}),m({pubkey:o[0]}),m({pubkey:new D(r.rewardInfos[0].vault)}),m({pubkey:ot,isWritable:!1}),m({pubkey:ke,isWritable:!1}),m({pubkey:o[1]}),m({pubkey:new D(r.rewardInfos[1].vault)})],f=Buffer.alloc(l.span);return l.encode({instruction:2,amount:s},f),new ce({keys:d,programId:c,data:f})}function kr(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=me({programId:c,poolId:u,owner:i,version:3}),d=Buffer.alloc(ue.span);ue.encode({instruction:11,amount:N(s)},d);let f=[m({pubkey:u}),m({pubkey:new D(r.authority),isWritable:!1}),m({pubkey:l}),m({pubkey:i,isWritable:!1,isSigner:!0}),m({pubkey:n}),m({pubkey:new D(r.lpVault)}),m({pubkey:o[0]}),m({pubkey:new D(r.rewardInfos[0].vault)}),m({pubkey:ot,isWritable:!1}),m({pubkey:ke,isWritable:!1})];if(a)for(let p of a)f.push(m({pubkey:p}));return new ce({programId:c,keys:f,data:d})}function Fn(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=me({programId:c,poolId:u,owner:i,version:3}),d=Buffer.alloc(ue.span);ue.encode({instruction:10,amount:N(s)},d);let f=[m({pubkey:u}),m({pubkey:new D(r.authority),isWritable:!1}),m({pubkey:l}),m({pubkey:i,isWritable:!1,isSigner:!0}),m({pubkey:n}),m({pubkey:new D(r.lpVault)}),m({pubkey:o[0]}),m({pubkey:new D(r.rewardInfos[0].vault)}),m({pubkey:ot,isWritable:!1}),m({pubkey:ke,isWritable:!1})];if(a)for(let p of a)f.push(m({pubkey:p}));return new ce({programId:c,keys:f,data:d})}function En(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s,userAuxiliaryLedgers:a}=e,[c,u]=[new D(t.programId),new D(t.id)],l=me({programId:c,poolId:u,owner:i,version:5}),d=Buffer.alloc(ue.span);ue.encode({instruction:11,amount:N(s)},d);let f=[m({pubkey:u}),m({pubkey:new D(r.authority),isWritable:!1}),m({pubkey:l}),m({pubkey:i,isWritable:!1,isSigner:!0}),m({pubkey:n}),m({pubkey:new D(r.lpVault)}),m({pubkey:o[0]}),m({pubkey:new D(r.rewardInfos[0].vault)}),m({pubkey:ot,isWritable:!1}),m({pubkey:ke,isWritable:!1})];for(let p=1;p<r.rewardInfos.length;p++)f.push(m({pubkey:o[p]})),f.push(m({pubkey:new D(r.rewardInfos[p].vault)}));if(a)for(let p of a)f.push(m({pubkey:p}));return new ce({programId:c,keys:f,data:d})}function Nn(e){let{farmInfo:t,farmKeys:r,lpAccount:n,rewardAccounts:o,owner:i,amount:s}=e,[a,c]=[new D(t.programId),new D(t.id)],u=me({programId:a,poolId:c,owner:i,version:6}),l=Buffer.alloc(ue.span);ue.encode({instruction:1,amount:N(s)},l);let d=[m({pubkey:ke,isWritable:!1}),m({pubkey:Rn.programId,isWritable:!1}),m({pubkey:c}),m({pubkey:new D(r.authority),isWritable:!1}),m({pubkey:new D(r.lpVault)}),m({pubkey:u}),m({pubkey:i,isWritable:!1,isSigner:!0}),m({pubkey:n})];for(let f=0;f<r.rewardInfos.length;f++)d.push(m({pubkey:new D(r.rewardInfos[f].vault)})),d.push(m({pubkey:o[f]}));return new ce({programId:a,keys:d,data:l})}var Ar=class extends rt{async _getUserRewardInfo({payer:t,rewardInfo:r}){if(r.mint.equals(ne)){let n=await sr({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:t,amount:yr(te(Y({},r),{openTime:r.openTime.toString(),endTime:r.endTime.toString()}))});return{rewardPubKey:n.addresses.newAccount,newInstruction:n}}return{rewardPubKey:await this.scope.account.getCreatedTokenAccount({mint:r.mint,associatedOnly:!1})}}async create({poolInfo:t,rewardInfos:r,payer:n,programId:o=Ye,txVersion:i}){this.checkDisabled(),this.scope.checkOwner();let a={lpMint:new q(t.lpMint.address),lockInfo:{lockMint:An,lockVault:In},version:6,rewardInfos:r,programId:o},c=this.createTxBuilder(),u=n!=null?n:this.scope.ownerPubKey,l=Kt({fromPublicKey:u,programId:a.programId}),d=await this.scope.connection.getMinimumBalanceForRentExemption(Ct.span);c.addInstruction({instructions:[ns.createAccountWithSeed({fromPubkey:u,basePubkey:u,seed:l.seed,newAccountPubkey:l.publicKey,lamports:d,space:Ct.span,programId:a.programId})]});let{publicKey:f,nonce:p}=Ln({programId:new q(a.programId),poolId:l.publicKey}),g=nt({programId:a.programId,poolId:l.publicKey,mint:a.lpMint,type:"lpVault"}),y=[],x=[];for(let A of a.rewardInfos){A.openTime>=A.endTime&&this.logAndCreateError("start time error","rewardInfo.rewardOpenTime",A.openTime.toString()),isNaN(Ke[A.rewardType])&&this.logAndCreateError("rewardType error",A.rewardType),Number(A.perSecond)<=0&&this.logAndCreateError("rewardPerSecond error",A.perSecond),y.push(Bn(A));let{rewardPubKey:I,newInstruction:F}=await this._getUserRewardInfo({rewardInfo:A,payer:u});F&&c.addInstruction(F),I||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts);let G=A.mint.equals(ne)?new q(se.address):A.mint;x.push({rewardMint:G,rewardVault:nt({programId:a.programId,poolId:l.publicKey,mint:G,type:"rewardVault"}),userRewardToken:I})}let{account:T,instructionParams:k}=await this.scope.account.getOrCreateTokenAccount({mint:new q(a.lockInfo.lockMint),owner:this.scope.ownerPubKey,skipCloseAccount:!1,createInfo:{payer:this.scope.ownerPubKey,amount:0},associatedOnly:!1});k&&c.addInstruction(k),T||this.logAndCreateError("cannot found lock vault","tokenAccounts",this.scope.account.tokenAccounts);let{instruction:b,instructionType:w}=Cn({farmId:l.publicKey,owner:this.scope.ownerPubKey,farmAuthority:f,lpVault:g,lpMint:a.lpMint,lockVault:a.lockInfo.lockVault,lockMint:a.lockInfo.lockMint,lockUserAccount:T,programId:a.programId,rewardInfo:x,rewardInfoConfig:y,nonce:p});return c.addInstruction({instructions:[b],instructionTypes:[w]}).versionBuild({txVersion:i,extInfo:{farmId:l.publicKey,farmAuthority:f,lpVault:g,lockUserAccount:T,nonce:p}})}async restartReward({farmInfo:t,payer:r,newRewardInfo:n,txVersion:o}){var x;let i=Te[t.programId];i!==6&&this.logAndCreateError("invalid farm version ",i);let s=we((await this.scope.api.fetchFarmKeysById({ids:t.id}))[0]),a={id:s.id,rewardInfos:t.rewardInfos,lpVault:s.lpVault,programId:s.programId};n.openTime>=n.endTime&&this.logAndCreateError("start time error","newRewardInfo",n);let c=r||this.scope.ownerPubKey,u=n.mint.equals(ne)?new q(se.address):n.mint,l=a.rewardInfos.findIndex(T=>new q(T.mint.address).equals(u)),d=s.rewardInfos[l];d||this.logAndCreateError("configuration does not exist","rewardMint",u);let f=(x=d.vault)!=null?x:ne,p=this.createTxBuilder(),{rewardPubKey:g,newInstruction:y}=await this._getUserRewardInfo({rewardInfo:n,payer:c});return y&&p.addInstruction(y),g||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts),p.addInstruction({instructions:[wr({payer:this.scope.ownerPubKey,rewardVault:f,userRewardTokenPub:g,farmKeys:a,rewardInfo:n})],instructionTypes:[j.FarmV6Restart]}).versionBuild({txVersion:o})}async restartRewards({farmInfo:t,payer:r,newRewardInfos:n,txVersion:o}){var l;let i=Te[t.programId];i!==6&&this.logAndCreateError("invalid farm version ",i);let s=we((await this.scope.api.fetchFarmKeysById({ids:t.id}))[0]),a={id:s.id,rewardInfos:t.rewardInfos,lpVault:s.lpVault,programId:s.programId};n.forEach(d=>{d.openTime>=d.endTime&&this.logAndCreateError("start time error","newRewardInfo",d)});let c=r||this.scope.ownerPubKey,u=this.createTxBuilder();for(let d of n){let f=d.mint.equals(ne)?new q(se.address):d.mint,p=a.rewardInfos.findIndex(b=>new q(b.mint.address).equals(f)),g=s.rewardInfos[p];g||this.logAndCreateError("configuration does not exist","rewardMint",f);let y=(l=g.vault)!=null?l:ne,{rewardPubKey:x,newInstruction:T}=await this._getUserRewardInfo({rewardInfo:d,payer:c});T&&u.addInstruction(T),x||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts);let k=wr({payer:this.scope.ownerPubKey,rewardVault:y,userRewardTokenPub:x,farmKeys:a,rewardInfo:d});u.addInstruction({instructions:[k],instructionTypes:[j.FarmV6Restart]})}return u.versionBuild({txVersion:o})}async addNewRewardToken(t){let{txVersion:r,farmInfo:n,newRewardInfo:o,payer:i}=t,s=Te[n.programId];s!==6&&this.logAndCreateError("invalid farm version ",s);let a=we((await this.scope.api.fetchFarmKeysById({ids:n.id}))[0]),c=i!=null?i:this.scope.ownerPubKey,u=this.createTxBuilder(),l=o.mint.equals(ne)?new q(se.address):o.mint,d=nt({programId:new q(n.programId),poolId:new q(n.id),mint:l,type:"rewardVault"}),{rewardPubKey:f,newInstruction:p}=await this._getUserRewardInfo({rewardInfo:o,payer:c});return p&&u.addInstruction(p),f||this.logAndCreateError("annot found target token accounts",this.scope.account.tokenAccounts),o.mint=l,u.addInstruction({instructions:[xr({payer:this.scope.ownerPubKey,userRewardTokenPub:f,farmKeys:a,rewardVault:d,rewardInfo:o})],instructionTypes:[j.FarmV6CreatorAddReward]}).versionBuild({txVersion:r})}async addNewRewardsToken(t){let{txVersion:r,farmInfo:n,newRewardInfos:o,payer:i}=t,s=Te[n.programId];s!==6&&this.logAndCreateError("invalid farm version ",s);let a=we((await this.scope.api.fetchFarmKeysById({ids:n.id}))[0]),c=i!=null?i:this.scope.ownerPubKey,u=this.createTxBuilder();for(let l of o){let d=l.mint.equals(ne)?new q(se.address):l.mint,f=nt({programId:new q(n.programId),poolId:new q(n.id),mint:d,type:"rewardVault"}),{rewardPubKey:p,newInstruction:g}=await this._getUserRewardInfo({rewardInfo:l,payer:c});g&&u.addInstruction(g),p||this.logAndCreateError("cannot found target token accounts",this.scope.account.tokenAccounts);let y=xr({payer:this.scope.ownerPubKey,userRewardTokenPub:p,farmKeys:a,rewardVault:f,rewardInfo:te(Y({},l),{mint:d})});u.addInstruction({instructions:[y],instructionTypes:[j.FarmV6CreatorAddReward]})}return u.versionBuild({txVersion:r})}async deposit(t){let{txVersion:r,farmInfo:n,amount:o,feePayer:i,useSOLBalance:s,associatedOnly:a=!0,checkCreateATAOwner:c=!1,userAuxiliaryLedgers:u,computeBudgetConfig:l}=t;this.scope.availability.addFarm===!1&&this.logAndCreateError("farm deposit feature disabled in your region");let{rewardInfos:d,programId:f}=n,p=Te[f];p===4&&this.logAndCreateError("V4 has suspended deposits:",n.programId),mr(p)||this.logAndCreateError("invalid farm program:",n.programId);let[g,y]=[new q(n.programId),new q(n.id)],x=(await this.scope.api.fetchFarmKeysById({ids:n.id}))[0],T=me({programId:g,poolId:y,owner:this.scope.ownerPubKey,version:p}),k=this.createTxBuilder();k.addCustomComputeBudget(l);let b={};for(let E of this.scope.account.tokenAccounts)if(a){let ee=De(this.scope.ownerPubKey,E.mint,E.programId).publicKey;E.publicKey&&ee.equals(E.publicKey)&&(b[E.mint.toString()]=E.publicKey)}else b[E.mint.toString()]=E.publicKey;let w=x.lpMint,A=b[w.address];A||this.logAndCreateError("you don't have any lp","lp zero",b);let I=[];for(let E of d){let ee=s&&E.mint.address===ge.toString(),z=b[E.mint.address];if(!z){let{account:W,instructionParams:it}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:E.mint.programId,mint:new q(E.mint.address),notUseTokenAccount:ee,createInfo:{payer:i||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!ee,associatedOnly:ee?!1:a,checkCreateATAOwner:c});z=W,it&&k.addInstruction(it)}b[E.mint.address]=z,I.push(z)}let F,G=await this.scope.connection.getAccountInfo(T);if(G&&(F=hr(p).decode(G.data)),n.programId!==Ye.toString()&&!F){let{instruction:E,instructionType:ee}=br({id:y,programId:g,version:p,ledger:T,owner:this.scope.ownerPubKey});k.addInstruction({instructions:[E],instructionTypes:[ee]})}let B=gr({version:p,rewardInfos:d,rewardTokenAccountsPublicKeys:I});B&&this.logAndCreateError(B);let K={amount:N(o),owner:this.scope.ownerPubKey,farmInfo:n,farmKeys:x,lpAccount:A,rewardAccounts:I,userAuxiliaryLedgers:u==null?void 0:u.map(E=>new q(E))},v=p===6?Nn(K):p===5?En(K):Fn(K),O={3:j.FarmV3Deposit,5:j.FarmV5Deposit,6:j.FarmV6Deposit};return k.addInstruction({instructions:[v],instructionTypes:[O[p]]}).versionBuild({txVersion:r})}async withdraw(t){let{txVersion:r,farmInfo:n,amount:o,deposited:i,useSOLBalance:s,feePayer:a,associatedOnly:c=!0,checkCreateATAOwner:u=!1,userAuxiliaryLedgers:l,computeBudgetConfig:d}=t,{rewardInfos:f}=n;this.scope.availability.removeFarm===!1&&this.logAndCreateError("farm withdraw feature disabled in your region");let p=Te[n.programId];mr(p)||this.logAndCreateError("invalid farm program:",n.programId);let g=(await this.scope.api.fetchFarmKeysById({ids:n.id}))[0],y=this.createTxBuilder();y.addCustomComputeBudget(d);let x={};for(let B of this.scope.account.tokenAccounts)if(c){let K=De(this.scope.ownerPubKey,B.mint).publicKey;B.publicKey&&K.equals(B.publicKey)&&(x[B.mint.toString()]=B.publicKey)}else x[B.mint.toString()]=B.publicKey;if(!i&&p!==4){let B=me({programId:new q(n.programId),poolId:new q(n.id),owner:this.scope.ownerPubKey,version:p}),K=await this.scope.connection.getAccountInfo(B);if(K)hr(p).decode(K.data).deposited.isZero()&&this.logAndCreateError("no deposited lp",{farmId:n.id});else if(p!==6&&(l||[]).length>0){let{instruction:v,instructionType:O}=br({id:new q(g.id),programId:new q(g.programId),version:p,ledger:B,owner:this.scope.ownerPubKey});y.addInstruction({instructions:[v],instructionTypes:[O]})}else this.logAndCreateError("no lp data",{farmId:n.id,version:p,ledgerData:K})}else i&&i.isZero()&&this.logAndCreateError("no deposited lp",{farmId:n.id});let T=g.lpMint.address,k=s&&T===ge.toString(),b=x[T.toString()];if(!b){let{account:B,instructionParams:K}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:g.lpMint.programId,mint:new q(T),notUseTokenAccount:k,createInfo:{payer:a||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!0,associatedOnly:k?!1:c,checkCreateATAOwner:u});b=B,K&&y.addInstruction(K)}x[T.toString()]=b;let w=[];for(let B of f){let K=s&&B.mint.address===ge.toString(),v=x[B.mint.address];if(!v){let{account:O,instructionParams:E}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:B.mint.programId,mint:new q(B.mint.address),notUseTokenAccount:K,createInfo:{payer:a||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!K,associatedOnly:K?!1:c,checkCreateATAOwner:u});v=O,E&&y.addInstruction(E)}x[B.mint.address]=v,w.push(v)}let A=gr({version:p,rewardInfos:f,rewardTokenAccountsPublicKeys:w});A&&this.logAndCreateError(A);let I={amount:N(o),owner:this.scope.ownerPubKey,farmInfo:n,farmKeys:g,lpAccount:b,rewardAccounts:w,userAuxiliaryLedgers:l==null?void 0:l.map(B=>new q(B))},F=p===6?Pr(I):p===5?Tr(I):p===4?Mn(I):kr(I),G={3:j.FarmV3Withdraw,4:j.FarmV4Withdraw,5:j.FarmV5Withdraw,6:j.FarmV6Withdraw};return y.addInstruction({instructions:[F],instructionTypes:[G[p]]}).versionBuild({txVersion:r})}async withdrawFarmReward({farmInfo:t,withdrawMint:r,txVersion:n}){var p;this.scope.checkOwner();let o=we((await this.scope.api.fetchFarmKeysById({ids:t.id}))[0]),i=Te[t.programId];i!==6&&this.logAndCreateError("invalid farm version",i);let s=t.rewardInfos.findIndex(g=>g.mint.address===ne.toString()?new q(se.address):r),a=o.rewardInfos[s];a||this.logAndCreateError("withdraw mint error","rewardInfos",t);let c=(p=a==null?void 0:a.vault)!=null?p:ne,u=this.createTxBuilder(),l;if(r.equals(ne)){let g=await sr({connection:this.scope.connection,owner:this.scope.ownerPubKey,payer:this.scope.ownerPubKey,amount:yr(te(Y({},a),{openTime:a.openTime,endTime:a.endTime,perSecond:new Wt(a.perSecond).mul(10**a.mint.decimals).toString()}))});l=g.addresses.newAccount,u.addInstruction(g)}else{let g=await this.scope.account.getCreatedTokenAccount({mint:r});g===null?(l=await this.scope.account.getAssociatedTokenAccount(r),u.addInstruction({instructions:[os(this.scope.ownerPubKey,l,this.scope.ownerPubKey,r)],instructionTypes:[j.CreateATA]})):l=g}let{instruction:d,instructionType:f}=Vn({programId:o.programId,id:o.id,authority:o.authority,lpVault:o.lpVault,rewardVault:c,userRewardToken:l,owner:this.scope.ownerPubKey});return u.addInstruction({instructions:[d],instructionTypes:[f]}).versionBuild({txVersion:n})}async harvestAllRewards(t){let{farmInfoList:r,useSOLBalance:n,feePayer:o,associatedOnly:i=!0,checkCreateATAOwner:s=!1,userAuxiliaryLedgers:a,txVersion:c,computeBudgetConfig:u}=t,l=this.createTxBuilder(),d={};for(let g of this.scope.account.tokenAccounts)if(i){let y=De(this.scope.ownerPubKey,g.mint).publicKey;g.publicKey&&y.equals(g.publicKey)&&(d[g.mint.toString()]=g.publicKey)}else d[g.mint.toString()]=g.publicKey;let p=(await this.scope.api.fetchFarmKeysById({ids:Object.values(r).map(g=>g.id).join(",")})).reduce((g,y)=>te(Y({},g),{[y.id]:y}),{});for(let g of Object.values(r)){let{programId:y,lpMint:x,rewardInfos:T,id:k}=g,b=Te[y],w=x.address,A=n&&w===ge.toString(),I=d[w];if(!I){let{account:O,instructionParams:E}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:x.programId,mint:new q(w),notUseTokenAccount:A,createInfo:{payer:o||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!0,associatedOnly:A?!1:i,checkCreateATAOwner:s});I=O,E&&l.addInstruction(E)}d[w.toString()]=I;let F=[];for(let O of T){let E=n&&O.mint.address===ge.toString(),ee=d[O.mint.address];if(!ee){let{account:z,instructionParams:W}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:O.mint.programId,mint:new q(O.mint.address),notUseTokenAccount:E,createInfo:{payer:o||this.scope.ownerPubKey,amount:0},owner:this.scope.ownerPubKey,skipCloseAccount:!E,associatedOnly:E?!1:i,checkCreateATAOwner:s});ee=z,W&&l.addInstruction(W)}d[O.mint.address]=ee,F.push(ee)}let G=p[k],B={amount:Xt,owner:this.scope.ownerPubKey,farmInfo:g,farmKeys:G,lpAccount:I,rewardAccounts:F,userAuxiliaryLedgers:a==null?void 0:a.map(O=>new q(O))},K=b===6?Pr(B):b===5?Tr(B):kr(B),v={3:j.FarmV3Withdraw,5:j.FarmV5Withdraw,6:j.FarmV6Withdraw};l.addInstruction({instructions:[K],instructionTypes:[v[b]]})}return c===1?l.sizeCheckBuild({computeBudgetConfig:u}):l.sizeCheckBuildV0({computeBudgetConfig:u})}};export{Ar as default};
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=farm.mjs.map